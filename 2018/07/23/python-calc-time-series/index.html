<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ja" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Python - 各種時刻系の変換！ - mk-mode BLOG</title>
<meta name="description" content="以前、 Ruby で各種時刻系を変換するスクリプトを作成しました。  Ruby - 各種時刻系の換算！今回は、同様のことを Python で行ってみました。">



<meta property="og:type" content="article">
<meta property="og:locale" content="ja_JP">
<meta property="og:site_name" content="mk-mode BLOG">
<meta property="og:title" content="Python - 各種時刻系の変換！">
<meta property="og:url" content="https://komasaru.github.io/2018/07/23/python-calc-time-series/">


  <meta property="og:description" content="以前、 Ruby で各種時刻系を変換するスクリプトを作成しました。  Ruby - 各種時刻系の換算！今回は、同様のことを Python で行ってみました。">



  <meta property="og:image" content="https://www.mk-mode.com/blog/assets/images/about_me.png">



  <meta name="twitter:site" content="@rsm_mzk">
  <meta name="twitter:title" content="Python - 各種時刻系の変換！">
  <meta name="twitter:description" content="以前、 Ruby で各種時刻系を変換するスクリプトを作成しました。  Ruby - 各種時刻系の換算！今回は、同様のことを Python で行ってみました。">
  <meta name="twitter:url" content="https://komasaru.github.io/2018/07/23/python-calc-time-series/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://www.mk-mode.com/blog/assets/images/about_me.png">
    
  

  



  <meta property="article:published_time" content="2018-07-23T00:20:00+09:00">





  

  


<link rel="canonical" href="https://komasaru.github.io/2018/07/23/python-calc-time-series/">





  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "url": "https://komasaru.github.io",
      "logo": "https://www.mk-mode.com/blog/assets/images/about_me.png"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "mk-mode.com",
      "url": "https://komasaru.github.io",
      "sameAs": null
    }
  </script>



  <meta name="google-site-verification" content="0kSwKhNo71fC7OeEFLllD3S11F8Pa-z_OqsBTSFxXAk" />





<!-- end _includes/seo.html -->


<link href="https://www.mk-mode.com/blog/atom.xml" type="application/atom+xml" rel="alternate" title="mk-mode BLOG Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


  
    
    <script defer src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    <!-- start custom head snippets -->

<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="//pagead2.googlesyndication.com" />
<link rel="dns-prefetch" href="//googleads.g.doubleclick.net" />
<link rel="dns-prefetch" href="//tpc.googlesyndication.com" />
<link rel="dns-prefetch" href="//cm.g.doubleclick.net" />
<link rel="dns-prefetch" href="//www.gstatic.com" />
<link rel="dns-prefetch" href="//fonts.gstatic.com" />
<link rel='dns-prefetch' href='//use.fontawesome.com' />
<link rel="dns-prefetch" href="//twitter.com" />
<link rel="dns-prefetch" href="//www.facebook.com" />

<link rel="icon" href="/assets/images/favicon.ico">
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18154748-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-7320193476057758",
      enable_page_level_ads: true
    });
  </script>


<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">mk-mode BLOG</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/year-archive/" >Archives</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.mk-mode.com/rails/calendar/calendar" >Calendar</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.mk-mode.com/rails/jmaxml" >JMAXML</a>
            </li><li class="masthead__menu-item">
              <a href="/privacy.html" >Privacy Policy</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/about_me.png" alt="mk-mode.com" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">mk-mode.com</h3>
    
    
      <p class="author__bio" itemprop="description">
        Linux, Debian, IT, Server, PG, Ruby, Rails, Python, C++, Fortran, PC, MariaDB, math, GIS, etc...
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Ruby City MATSUE</span>
        </li>
      

      
        
          
        
          
            <li><a href="https://www.mk-mode.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode SITE</a></li>
          
        
          
            <li><a href="https://www.mk-mode.com/blog" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode BLOG (original)</a></li>
          
        
          
            <li><a href="https://mk-mode.tumblr.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode TUMBLR</a></li>
          
        
          
            <li><a href="https://mk-ephemeris.tumblr.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode EPHEMERIS</a></li>
          
        
          
            <li><a href="https://twitter.com/rsm_mzk" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
          
        
          
        
          
            <li><a href="https://github.com/komasaru" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Python - 各種時刻系の変換！">
    <meta itemprop="description" content="以前、 Ruby で各種時刻系を変換するスクリプトを作成しました。  Ruby - 各種時刻系の換算！今回は、同様のことを Python で行ってみました。">
    <meta itemprop="datePublished" content="July 23, 2018">
    

    <div class="page__inner-wrap">
      
        <header>
          <!-- div id="google-ad-1"></div -->
          <h1 id="page-title" class="page__title" itemprop="headline">Python - 各種時刻系の変換！
</h1>
          
          
            
            <p class="page__date"><small><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2018-07-23T00:20:00+09:00">2018-07-23 00:20</time></small></p>
          
        </header>
      
      <div id="google-ad-2"></div>
      <br />

      <section class="page__content" itemprop="text">
        
        <p>以前、 Ruby で各種時刻系を変換するスクリプトを作成しました。</p>

<ul>
  <li><a href="/2016/04/02/ruby-calc-time-series" title="Ruby - 各種時刻系の換算！">Ruby - 各種時刻系の換算！</a></li>
</ul>

<p>今回は、同様のことを Python で行ってみました。</p>

<!--more-->

<h3 id="0-前提条件">0. 前提条件</h3>

<ul>
  <li>Python 3.6.5 での作業を想定。</li>
  <li>天文学的な計算については疎いため、誤りがあるかもしれない。</li>
</ul>

<h3 id="1-各種時刻系について">1. 各種時刻系について</h3>

<p>原子時系（世界時系を含む）、力学時系、座標時系の順に記述。</p>

<ul>
  <li>TAI（国際原子時; International Atomic Time）
    <ul>
      <li>UTC（協定世界時）を含む他の時刻基準の計算の基となる基礎的な国際時刻基準。</li>
      <li>原子時計によって定義される高精度＆安定、地球ジオイド面での時刻系。</li>
      <li>1 秒は SI 秒。</li>
    </ul>
  </li>
  <li>UT（世界時; Universal Time）
    <ul>
      <li>ロンドンの旧グリニッジ天文台を通る子午線上で、平均太陽（平均的な動きの太陽）が南中する瞬間を12時として定義されている。</li>
      <li>UT0, UT1, UT2, UTC の種類がある。</li>
      <li>単に UT と呼んだ場合は UT1 を指すことが多い。</li>
    </ul>
  </li>
  <li>UT0（世界時0; Universal Time 0）
    <ul>
      <li>世界各地の恒星や地球外の電波源の日周運動の観測結果を経度の差によって本初子午線における換算し平均して求めた時刻系。</li>
      <li>極運動の効果（地球の地理学的極と自転軸の極とのずれ）の補正を含まない。（特定の観測地での地球自転に基づく時刻）</li>
    </ul>
  </li>
  <li>UT1（世界時1; Universal Time 1）
    <ul>
      <li>UT0 から観測地の経度に表れる極運動の効果（地球の地理学的極と自転軸の極とのずれ）を補正した（観測地点に依存しない）時刻系。</li>
      <li>いわゆる地球の自転による時刻系。</li>
      <li>地球自転が一定していないため、季節により変動する。</li>
      <li>UT1 = UTC + DUT1</li>
    </ul>
  </li>
  <li>UT2（世界時2; Universal Time 2）
    <ul>
      <li>UT1 に季節変化を考慮（UT1 から年周期・半年周期等の成分の大部分を除外）した時刻系。</li>
    </ul>
  </li>
  <li>UTC（協定世界時, Coordinated Universal Time）
    <ul>
      <li>TAI（国際原子時）に由来する原子時系時刻で、UT1（世界時1）に同調するよう調整された基準時刻。</li>
      <li>世界各地の標準の基準となっている。</li>
      <li>TAI（国際原子時）から整数秒ずれている。</li>
      <li>UT1 - TAI の絶対値が 0.9 秒以内となるよううるう秒で調整されている。</li>
      <li>TAI = UTC - (UTC - TAI) = UTC - うるう秒の総和</li>
      <li>現時点の UTC - TAI（うるう秒の総和）は「[こちら](http://jjy.nict.go.jp/QandA/data/leapsec.html “”)」を参照。</li>
      <li>1 秒 = SI 秒</li>
    </ul>
  </li>
  <li>DUT1（ΔUT1）
    <ul>
      <li>DUT1 = UT1 - UTC</li>
      <li>現在は DUT1 の絶対値が1秒を越えないよう、うるう秒による調整が行われている。</li>
      <li>現時点の DUT1 は「[こちら](http://jjy.nict.go.jp/QandA/data/dut1.html “”)」を参照。</li>
    </ul>
  </li>
  <li>TT（地球時; Terrestrial Time）
    <ul>
      <li>かつて TDT（地球力学時）と呼ばれていた時刻系を再定義したもので、地球ジオイド面での座表時。</li>
      <li>TAI の1977年1月1日0時0分0秒を力学時の1977年1月1.0003725日とし、TT の１日は平均海面における原子時計による秒の86400倍と定義されている。<br />
（0.0003725 日 = 32.184 秒）</li>
      <li>元期 J2000.0 は、ユリウス日で 2,451,545.0 TT（2000年1月1日12h TT）。</li>
      <li>1 秒は SI 秒。</li>
      <li>TT = TAI + 32.184 （秒）<br />
さらには、
        <ul>
          <li>= UTC - (UTC - TAI) + 32.184</li>
          <li>= UTC - うるう秒の総和 + 32.184</li>
          <li>= UT1 - (UT1 - UTC) - うるう秒の総和 + 32.184</li>
          <li>= UT1 - DUT1 - うるう秒の総和 + 32.184</li>
          <li>= UT1 + ΔT<br />
（但し、 ΔT は地球時と世界時のズレ。ユリウス日から直接 ΔT を求めるには「<a href="http://eclipse.gsfc.nasa.gov/SEcat5/deltatpoly.html" title="NASA - Polynomial Expressions for Delta T">NASA - Polynomial Expressions for Delta T</a>」を参照）</li>
        </ul>
      </li>
      <li>ΔT = TT - UT1 = TAI - UTC - DUT1 + 32.184</li>
    </ul>
  </li>
  <li>TDT（地球力学時; Terrestrial Dynamical Time）
    <ul>
      <li>かつて使われていた力学時。</li>
      <li>現在は使用されていない。</li>
      <li>TDT = TT = TAI + 32.184 （秒）</li>
    </ul>
  </li>
  <li>TDB（太陽系力学時; Barycentric Dynamical Time）
    <ul>
      <li>太陽系重心における力学時。</li>
      <li>一般相対性理論による重力の影響が加味されれている。</li>
      <li>TT と比較すると周期的項が異なるが、その差は極小（最大でも10ms程度）のため無視しても問題ない。<br />
TDB = TT + TDB_0 + 周期項<br />
（但し、 TDB_0 = -6.55 * 10^(-5)）</li>
      <li>2006年のIAU勧告では TDB は次のように定義された。（TDB は TT, TCG, TCB と原点がわずかにずれているため）<br />
TDB = TCB - L_B * (JD_TCB - T_0) * 86400 + TDB_0<br />
（但し、 JD_TCB: TCB におけるユリウス日, L_B = 1.550519768 * 10^(-8), T_0 = 2443144.5003725, TDB_0 = -6.55 * 10^(-5)）</li>
    </ul>
  </li>
  <li>TCG（地球重心座標時; Geocentric Coordinate Time）
    <ul>
      <li>地球重心を原点として考える座標時。</li>
      <li>周期的項はない。</li>
      <li>TT と比較して1年あたり約22ミリ秒速く進む。</li>
      <li>TCG - TT = L_G * (JD - T_0) * 86,400<br />
（但し、 JD: ユリウス日, L_G = 6.969290134 * 10^(-10), T_0 = 2443144.5003725）</li>
      <li>dTT / dTCG = 1 - L_G<br />
（但し、L_G = 6.969290134 * 10^(-10)）
（詳細不明）</li>
    </ul>
  </li>
  <li>TCB（太陽系重心座標時; Barycentric Coordinate Time)
    <ul>
      <li>太陽系重心を原点として考える座標時。</li>
      <li>TT と比較して1年あたり約0.49秒速く進む。</li>
      <li>小さな周期的項が存在するが、周期項を無視して平均化すると、<br />
TCB - TT = L_B * (JD - T_0) * 86400</li>
      <li>2006年IAU勧告では、TDB（太陽系力学時）と TCB（太陽系重心座標時）の関係を次の一次式で定義するすることが推奨されている。<br />
TDB = TCB − L_B * (JD_TCB − T_0) * 86,400 + TDB_0<br />
（但し、 JD_TCB: TCB におけるユリウス日, L_B = 1.550519768 * 10^(-8), T_0 = 2443144.5003725, TDB_0 = -6.55 * 10^(-5)）</li>
      <li>dTCG / dATCB = 1 - L_C<br />
（但し、L_C = 1.4808268674 * 10^(-8), TCB = ATCB + 周期的項（1.6ms程度）, ATCB = Average of TCB）
（詳細不明）</li>
    </ul>
  </li>
</ul>

<h3 id="2-python-スクリプトの作成">2. Python スクリプトの作成</h3>

<p>次のスクリプトは実行部分。</p>

<p>File: <code class="language-plaintext highlighter-rouge">conv_time.py</code></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
</pre></td><td class="code"><pre><span class="c1">#! /usr/local/bin/python3.6
</span><span class="s">"""
各種時刻換算

  date          name            version
  2018.04.26    mk-mode         1.00 新規作成

Copyright(C) 2018 mk-mode.com All Rights Reserved.
---
  引数 : JST（日本標準時）
           書式：YYYYMMDD or YYYYMMDDHHMMSS or YYYYMMDDHHMMSSUUUUUU
           無指定なら現在(システム日時)と判断。（上記の U はマイクロ秒）
---
* 定数 DUT1 (= UT1 - UTC) の値は以下を参照。
    [日本標準時プロジェクト Announcement of DUT1]
    (http://jjy.nict.go.jp/QandA/data/dut1.html)
  但し、値は 1.0 秒以下なので、精度を問わないなら 0.0 固定でもよい(?)
* UTC - TAI（協定世界時と国際原子時の差）は、以下のとおりとする。
  - 1972年07月01日より古い場合は一律で 10
  - 2019年07月01日以降は一律で 37
  - その他は、指定の値
    [日本標準時プロジェクト　Information of Leap second]
    (http://jjy.nict.go.jp/QandA/data/leapsec.html)
* ΔT = TT - UT1 は、以下のとおりとする。
  - 1972-01-01 以降、うるう秒挿入済みの年+2までは、以下で算出
      ΔT = 32.184 - (UTC - TAI) - DUT1
    UTC - TAI は
    [うるう秒実施日一覧](http://jjy.nict.go.jp/QandA/data/leapsec.html)
    を参照
  - その他の期間は NASA 提供の略算式により算出
    [NASA - Polynomial Expressions for Delta T]
    (http://eclipse.gsfc.nasa.gov/SEcat5/deltatpoly.html)
"""</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">lib</span> <span class="kn">import</span> <span class="n">delta_t</span> <span class="k">as</span> <span class="n">ldt</span>
<span class="kn">from</span> <span class="nn">lib</span> <span class="kn">import</span> <span class="n">time_</span>   <span class="k">as</span> <span class="n">ltm</span>


<span class="k">class</span> <span class="nc">ConvTime</span><span class="p">:</span>
    <span class="n">MSG_ERR_1</span> <span class="o">=</span> <span class="s">"[ERROR] Format: YYYYMMDD or YYYYMMDDHHMMSS or YYYYMMDDHHMMSSUUUUUU"</span>
    <span class="n">MSG_ERR_2</span> <span class="o">=</span> <span class="s">"[ERROR] Invalid date!"</span>
    <span class="n">JST_UTC</span> <span class="o">=</span> <span class="mi">9</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">__get_arg</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">exec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">jd</span>      <span class="o">=</span> <span class="n">ltm</span><span class="p">.</span><span class="n">gc2jd</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">utc</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">t</span>       <span class="o">=</span> <span class="n">ltm</span><span class="p">.</span><span class="n">jd2jc</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">jd</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">utc_tai</span> <span class="o">=</span> <span class="n">ltm</span><span class="p">.</span><span class="n">utc2utc_tai</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">utc</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">dut1</span>    <span class="o">=</span> <span class="n">ltm</span><span class="p">.</span><span class="n">utc2dut1</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">utc</span><span class="p">)</span>
            <span class="n">odt</span>          <span class="o">=</span> <span class="n">ldt</span><span class="p">.</span><span class="n">DeltaT</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">utc</span><span class="p">.</span><span class="n">year</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">dt</span>      <span class="o">=</span> <span class="n">odt</span><span class="p">.</span><span class="n">delta_t</span><span class="p">()</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tai</span>     <span class="o">=</span> <span class="n">ltm</span><span class="p">.</span><span class="n">utc2tai</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">utc</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">utc_tai</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">ut1</span>     <span class="o">=</span> <span class="n">ltm</span><span class="p">.</span><span class="n">utc2ut1</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">utc</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">dut1</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tt</span>      <span class="o">=</span> <span class="n">ltm</span><span class="p">.</span><span class="n">tai2tt</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tai</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tcg</span>     <span class="o">=</span> <span class="n">ltm</span><span class="p">.</span><span class="n">tt2tcg</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tt</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">jd</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tcb</span>     <span class="o">=</span> <span class="n">ltm</span><span class="p">.</span><span class="n">tt2tcb</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tt</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">jd</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">jd_tcb</span>  <span class="o">=</span> <span class="n">ltm</span><span class="p">.</span><span class="n">gc2jd</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tcb</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">tdb</span>     <span class="o">=</span> <span class="n">ltm</span><span class="p">.</span><span class="n">tcb2tdb</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tcb</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">jd_tcb</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">__display</span><span class="p">()</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">__get_arg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">""" 引数取得
            * コマンドライン引数を取得して日時の妥当性チェックを行う。
            * コマンドライン引数無指定なら、現在日時とする。
            * JST, UTC をインスタンス変数 jst, utc に格納する。
        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">jst</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s">"^(\d{8}|\d{14}|\d{20})$"</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">MSG_ERR_1</span><span class="p">)</span>
                    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="n">arg</span><span class="p">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s">"0"</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">jst</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="s">"%Y%m%d%H%M%S%f"</span><span class="p">)</span>
                <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">MSG_ERR_2</span><span class="p">)</span>
                    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">utc</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">jst</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">JST_UTC</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">__display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">""" 結果出力 """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">print</span><span class="p">((</span>
                <span class="s">"      JST: {}</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"      UTC: {}</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"JST - UTC: {} hours</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"       JD: {:.10f} days</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"        T: {:.10f} century (= Julian Century Number)</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"UTC - TAI: {} seconds (= amount of leap seconds)</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"     DUT1: {:.1f} seconds</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"  delta T: {:.3f} seconds</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"      TAI: {}</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"      UT1: {}</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"       TT: {}</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"      TCG: {}</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"      TCB: {}</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"   JD_TCB: {:.10f} days</span><span class="se">\n</span><span class="s">"</span>
                <span class="s">"      TDB: {}"</span>
            <span class="p">).</span><span class="nb">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">jst</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%Y-%m-%d %H:%M:%S.%f'</span><span class="p">),</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">utc</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%Y-%m-%d %H:%M:%S.%f'</span><span class="p">),</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">JST_UTC</span><span class="p">,</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">jd</span><span class="p">,</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">t</span><span class="p">,</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">utc_tai</span><span class="p">,</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">dut1</span><span class="p">,</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">dt</span><span class="p">,</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">tai</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%Y-%m-%d %H:%M:%S.%f'</span><span class="p">),</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">ut1</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%Y-%m-%d %H:%M:%S.%f'</span><span class="p">),</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">tt</span> <span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%Y-%m-%d %H:%M:%S.%f'</span><span class="p">),</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">tcg</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%Y-%m-%d %H:%M:%S.%f'</span><span class="p">),</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">tcb</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%Y-%m-%d %H:%M:%S.%f'</span><span class="p">),</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">jd_tcb</span><span class="p">,</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">tdb</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%Y-%m-%d %H:%M:%S.%f'</span><span class="p">)</span>
            <span class="p">))</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ConvTime</span><span class="p">()</span>
        <span class="n">obj</span><span class="p">.</span><span class="k">exec</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">traceback</span><span class="p">.</span><span class="n">print_exc</span><span class="p">()</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>次のスクリプトはライブラリ部分。（lib ディレクトリを作成後、その配下へ）</p>

<ul>
  <li>うるう秒の最新情報は、「<a href="http://jjy.nict.go.jp/QandA/data/leapsec.html">うるう秒実施日一覧</a>」で確認すること。</li>
  <li>DUT1 の最新情報は、「<a href="http://jjy.nict.go.jp/QandA/data/dut1.html">日本標準時プロジェクト Announcement of DUT1</a>」で確認すること。</li>
  <li>うるう秒が実施されていない時期のΔTは、 NASA 提供の略算式による。（参照： <a href="http://eclipse.gsfc.nasa.gov/SEcat5/deltatpoly.html">NASA - Polynomial Expressions for Delta T</a>）</li>
</ul>

<p>File: <code class="language-plaintext highlighter-rouge">lib/time_.py</code></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
</pre></td><td class="code"><pre><span class="s">"""
各種時刻換算用ライブラリ
"""</span>
<span class="kn">import</span> <span class="nn">datetime</span>


<span class="c1"># Constants
</span><span class="n">J2000</span>   <span class="o">=</span> <span class="mi">2451545</span>          <span class="c1"># Reference epoch (J2000.0), Julian Date
</span><span class="n">JC</span>      <span class="o">=</span> <span class="mi">36525</span>            <span class="c1"># Days per Julian century
</span><span class="n">DAYSEC</span>  <span class="o">=</span> <span class="mi">86400</span>            <span class="c1"># Seconds per a day
</span><span class="n">TT_TAI</span>  <span class="o">=</span> <span class="mf">32.184</span>           <span class="c1"># TT - TAI
</span><span class="n">L_G</span>     <span class="o">=</span> <span class="mf">6.969290134e-10</span>  <span class="c1"># for TCG
</span><span class="n">L_B</span>     <span class="o">=</span> <span class="mf">1.550519768e-8</span>   <span class="c1"># for TCB, TDB
</span><span class="n">T_0</span>     <span class="o">=</span> <span class="mf">2443144.5003725</span>  <span class="c1"># for TCG, TDB, TCB
</span><span class="n">TDB_0</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">6.55e-5</span>         <span class="c1"># for TDB
</span><span class="n">LEAP_SEC</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s">"19720101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19720701"</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19730101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19740101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19750101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19760101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19770101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19780101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">17</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19790101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19800101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19810701"</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19820701"</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19830701"</span><span class="p">,</span> <span class="o">-</span><span class="mi">22</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19850701"</span><span class="p">,</span> <span class="o">-</span><span class="mi">23</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19880101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">24</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19900101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19910101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">26</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19920701"</span><span class="p">,</span> <span class="o">-</span><span class="mi">27</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19930701"</span><span class="p">,</span> <span class="o">-</span><span class="mi">28</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19940701"</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19960101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19970701"</span><span class="p">,</span> <span class="o">-</span><span class="mi">31</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19990101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20060101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">33</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20090101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">34</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20120701"</span><span class="p">,</span> <span class="o">-</span><span class="mi">35</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20150701"</span><span class="p">,</span> <span class="o">-</span><span class="mi">36</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20170101"</span><span class="p">,</span> <span class="o">-</span><span class="mi">37</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20190101"</span><span class="p">,</span>   <span class="mi">0</span><span class="p">]</span>  <span class="c1"># (&lt;= Provisional end-point)
</span><span class="p">]</span>
<span class="n">DUT1</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s">"19880317"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19880512"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19880825"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19881110"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19890119"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19890406"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19890608"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19890921"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19891116"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19900101"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19900301"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19900412"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19900510"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19900726"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19900920"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19901101"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19910101"</span><span class="p">,</span>  <span class="mf">0.6</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19910207"</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19910321"</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19910425"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19910620"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19910822"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19911017"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19911121"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19920123"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19920227"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19920402"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19920507"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19920701"</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19920903"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19921022"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19921126"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19930114"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19930218"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19930401"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19930506"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19930701"</span><span class="p">,</span>  <span class="mf">0.6</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19930819"</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19931007"</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19931118"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19931230"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19940210"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19940317"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19940421"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19940609"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19940701"</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19940811"</span><span class="p">,</span>  <span class="mf">0.7</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19941006"</span><span class="p">,</span>  <span class="mf">0.6</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19941117"</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19941222"</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19950223"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19950316"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19950413"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19950525"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19950713"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19950907"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19951026"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19951130"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19960101"</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19960222"</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19960411"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19960516"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19960808"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19961003"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19961205"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19970206"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19970320"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19970508"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19970626"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19970701"</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19970918"</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19971030"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19971218"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19980219"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19980326"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19980507"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19980813"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19981126"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19990101"</span><span class="p">,</span>  <span class="mf">0.7</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19990304"</span><span class="p">,</span>  <span class="mf">0.6</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19990527"</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"19991014"</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20000106"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20000413"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20001019"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20010301"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20011004"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20020214"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20021024"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20030403"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20040429"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20050317"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20060101"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20060427"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20060928"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20061222"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20070315"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20070614"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20071129"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20080313"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20080807"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20081120"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20090101"</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20090312"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20090611"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20091112"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20100311"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20100603"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20110106"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20110512"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20111104"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20120209"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20120510"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20120701"</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20121025"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20130131"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20130411"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20130822"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20131121"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20140220"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20140508"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20140925"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20141225"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20150319"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20150528"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20150701"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20150917"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20151126"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20160131"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20160324"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20160519"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20160901"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20161117"</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20170101"</span><span class="p">,</span>  <span class="mf">0.6</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20170126"</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20170330"</span><span class="p">,</span>  <span class="mf">0.4</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20170629"</span><span class="p">,</span>  <span class="mf">0.3</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20171130"</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20180315"</span><span class="p">,</span>  <span class="mf">0.1</span><span class="p">],</span>
    <span class="p">[</span><span class="s">"20180615"</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># (&lt;= Provisional end-point)
</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">gc2jd</span><span class="p">(</span><span class="n">gc</span><span class="p">):</span>
    <span class="s">""" ユリウス日の計算

    :param  datetime gc: グレゴリオ暦
    :return float    jd: ユリウス日
    """</span>
    <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span>  <span class="n">day</span>    <span class="o">=</span> <span class="n">gc</span><span class="p">.</span><span class="n">year</span><span class="p">,</span> <span class="n">gc</span><span class="p">.</span><span class="n">month</span><span class="p">,</span>  <span class="n">gc</span><span class="p">.</span><span class="n">day</span>
    <span class="n">hour</span><span class="p">,</span> <span class="n">minute</span><span class="p">,</span> <span class="n">second</span> <span class="o">=</span> <span class="n">gc</span><span class="p">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">gc</span><span class="p">.</span><span class="n">minute</span><span class="p">,</span> <span class="n">gc</span><span class="p">.</span><span class="n">second</span>
    <span class="n">second</span> <span class="o">+=</span> <span class="n">gc</span><span class="p">.</span><span class="n">microsecond</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">month</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">year</span>  <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">month</span> <span class="o">+=</span> <span class="mi">12</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">365.25</span> <span class="o">*</span> <span class="n">year</span><span class="p">)</span> <span class="o">+</span> <span class="n">year</span> <span class="o">//</span> <span class="mi">400</span>  <span class="o">-</span> <span class="n">year</span> <span class="o">//</span> <span class="mi">100</span> \
          <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="mf">30.59</span> <span class="o">*</span> <span class="p">(</span><span class="n">month</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">day</span> <span class="o">+</span> <span class="mf">1721088.5</span>
        <span class="n">t</span>  <span class="o">=</span> <span class="p">(</span><span class="n">second</span> <span class="o">/</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">minute</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">hour</span><span class="p">)</span> <span class="o">/</span> <span class="mi">24</span>
        <span class="k">return</span> <span class="n">d</span> <span class="o">+</span> <span class="n">t</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">jd2t</span><span class="p">(</span><span class="n">jd</span><span class="p">):</span>
    <span class="s">""" ユリウス世紀数の計算

    :param  float jd: ユリウス日
    :return float  t: ユリウス世紀数
    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">jd</span> <span class="o">-</span> <span class="n">J2000</span><span class="p">)</span> <span class="o">/</span> <span class="n">JC</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">utc2utc_tai</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" UTC - TAI (協定世界時と国際原子時の差 = うるう秒の総和)

    :param  datetime  utc: 協定世界時
    :return float utc_tai: 協定世界時と国際原子時の差(うるう秒の総和)
                           (Unit: seconds)
    """</span>
    <span class="n">utc_tai</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">"%Y%m%d"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">date</span><span class="p">,</span> <span class="n">sec</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">LEAP_SEC</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">date</span> <span class="o">&lt;=</span> <span class="n">target</span><span class="p">:</span>
                <span class="n">utc_tai</span> <span class="o">=</span> <span class="n">sec</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">utc_tai</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">utc2dut1</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" DUT1 (= UT1(世界時1) - UTC(協定世界時)) の取得
        * Ref: http://jjy.nict.go.jp/QandA/data/dut1.html

    :param  datetime utc: 協定世界時
    :return float   dut1: DUT1 (Unit: seconds)
    """</span>
    <span class="n">dut1</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">"%Y%m%d"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">date</span><span class="p">,</span> <span class="n">sec</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">DUT1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">date</span> <span class="o">&lt;=</span> <span class="n">target</span><span class="p">:</span>
                <span class="n">dut1</span> <span class="o">=</span> <span class="n">sec</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">dut1</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">utc2dt</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" UTC -&gt; ΔT
        * うるう秒調整が明確な場合は、うるう秒総和を使用した計算
        * そうでない場合は、NASA の計算式による計算

    :param  datetime utc: 協定世界時
    :return float     dt: ΔT (Unit: seconds)
    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span>                        <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="o">-</span><span class="mi">500</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_m500</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="o">-</span><span class="mi">500</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>   <span class="mi">500</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_500</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span>  <span class="mi">500</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="mi">1600</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_1600</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">1600</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="mi">1700</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_1700</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">1700</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="mi">1800</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_1800</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">1800</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="mi">1860</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_1860</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">1860</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="mi">1900</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_1900</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">1900</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="mi">1920</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_1920</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">1920</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="mi">1941</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_1941</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">1941</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="mi">1961</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_1961</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">1961</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="mi">1986</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_1986</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">1986</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="mi">2005</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_2005</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">2005</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;</span>  <span class="mi">2050</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_before_2050</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">2050</span> <span class="o">&lt;=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="ow">and</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">2150</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_until_2150</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">elif</span> <span class="mi">2150</span> <span class="o">&lt;</span>  <span class="n">utc</span><span class="p">.</span><span class="n">year</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">__dt_after_2150</span><span class="p">(</span><span class="n">utc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dt</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_m500</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" year &lt; -500    dt: ΔT

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1820</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">20</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_500</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" -500 &lt;= year and year &lt; 500

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">10583.6</span>           \
            <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1014.41</span>          \
            <span class="o">+</span> <span class="p">(</span>   <span class="mf">33.78311</span>       \
            <span class="o">+</span> <span class="p">(</span>   <span class="o">-</span><span class="mf">5.952053</span>      \
            <span class="o">+</span> <span class="p">(</span>   <span class="o">-</span><span class="mf">0.1798452</span>     \
            <span class="o">+</span> <span class="p">(</span>    <span class="mf">0.022174192</span>   \
            <span class="o">+</span> <span class="p">(</span>    <span class="mf">0.0090316521</span><span class="p">)</span> \
            <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_1600</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 500 &lt;= year and year &lt; 1600

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">1574.2</span>           \
            <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">556.01</span>          \
            <span class="o">+</span> <span class="p">(</span>  <span class="mf">71.23472</span>       \
            <span class="o">+</span> <span class="p">(</span>   <span class="mf">0.319781</span>      \
            <span class="o">+</span> <span class="p">(</span>  <span class="o">-</span><span class="mf">0.8503463</span>     \
            <span class="o">+</span> <span class="p">(</span>  <span class="o">-</span><span class="mf">0.005050998</span>   \
            <span class="o">+</span> <span class="p">(</span>   <span class="mf">0.0083572073</span><span class="p">)</span> \
            <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_1700</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 1600 &lt;= year and year &lt; 1700

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1600</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">120</span>           \
            <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="mf">0.9808</span>      \
            <span class="o">+</span> <span class="p">(</span> <span class="o">-</span><span class="mf">0.01532</span>     \
            <span class="o">+</span> <span class="p">(</span>  <span class="mf">1.0</span> <span class="o">/</span> <span class="mi">7129</span><span class="p">)</span> \
            <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_1800</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 1700 &lt;= year and year &lt; 1800

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1700</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">8.83</span>           \
           <span class="o">+</span> <span class="p">(</span> <span class="mf">0.1603</span>         \
           <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.0059285</span>      \
           <span class="o">+</span> <span class="p">(</span> <span class="mf">0.00013336</span>     \
           <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">1174000</span><span class="p">)</span> \
           <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_1860</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 1800 &lt;= year and year &lt; 1860

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1800</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">13.72</span>            \
            <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.332447</span>        \
            <span class="o">+</span> <span class="p">(</span> <span class="mf">0.0068612</span>       \
            <span class="o">+</span> <span class="p">(</span> <span class="mf">0.0041116</span>       \
            <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.00037436</span>      \
            <span class="o">+</span> <span class="p">(</span> <span class="mf">0.0000121272</span>    \
            <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.0000001699</span>    \
            <span class="o">+</span> <span class="p">(</span> <span class="mf">0.000000000875</span><span class="p">)</span> \
            <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_1900</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 1860 &lt;= year and year &lt; 1900

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1860</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">7.62</span>          \
           <span class="o">+</span> <span class="p">(</span> <span class="mf">0.5737</span>        \
           <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.251754</span>      \
           <span class="o">+</span> <span class="p">(</span> <span class="mf">0.01680668</span>    \
           <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.0004473624</span>  \
           <span class="o">+</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mi">233174</span><span class="p">)</span> \
           <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_1920</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 1900 &lt;= year and year &lt; 1920

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1900</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">2.79</span>      \
            <span class="o">+</span> <span class="p">(</span> <span class="mf">1.494119</span>  \
            <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.0598939</span> \
            <span class="o">+</span> <span class="p">(</span> <span class="mf">0.0061966</span> \
            <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.000197</span><span class="p">)</span> \
            <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_1941</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 1920 &lt;= year and year &lt; 1941

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1920</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">21.20</span>       \
            <span class="o">+</span> <span class="p">(</span> <span class="mf">0.84493</span>    \
            <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.076100</span>   \
            <span class="o">+</span> <span class="p">(</span> <span class="mf">0.0020936</span><span class="p">)</span> \
            <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_1961</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 1941 &lt;= year and year &lt; 1961

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1950</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">29.07</span>        \
            <span class="o">+</span> <span class="p">(</span> <span class="mf">0.407</span>       \
            <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">233</span>   \
            <span class="o">+</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mi">2547</span><span class="p">)</span> \
            <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_1986</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 1961 &lt;= year and year &lt; 1986

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1975</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1972</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># 1972年1月より前は NASA 提供の略算式で
</span>            <span class="k">return</span> <span class="mf">45.45</span>       \
                <span class="o">+</span> <span class="p">(</span> <span class="mf">1.067</span>      \
                <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">260</span>  \
                <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">718</span><span class="p">)</span> \
                <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1972</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">10</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1973</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">11</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1974</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">12</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1975</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">13</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1976</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">14</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1977</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">15</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1978</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">16</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1979</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">17</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1980</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">18</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1981</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">19</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1982</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">20</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1983</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">21</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1985</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">22</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1988</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">23</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_2005</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 1986 &lt;= year and year &lt; 2005

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">2000</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 以下の7行は NASA 提供の略算式
</span>        <span class="c1">#return 63.86           \
</span>        <span class="c1">#    + ( 0.3345         \
</span>        <span class="c1">#    + (-0.060374       \
</span>        <span class="c1">#    + ( 0.0017275      \
</span>        <span class="c1">#    + ( 0.000651814    \
</span>        <span class="c1">#    + ( 0.00002373599) \
</span>        <span class="c1">#    * t) * t) * t) * t) * t
</span>        <span class="k">if</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1988</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">23</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">24</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1991</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">25</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1992</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">26</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1993</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">27</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1994</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">28</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1996</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">29</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1997</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">30</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1999</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">31</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">32</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_before_2050</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 2005 &lt;= year and year &lt; 2050

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">2000</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">32</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">33</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">34</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">35</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">36</span>
        <span class="k">elif</span> <span class="n">utc</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># 第28回うるう秒実施までの暫定措置
</span>            <span class="k">return</span> <span class="n">TT_TAI</span> <span class="o">+</span> <span class="mi">37</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># 2019年1月以降は NASA 提供の略算式で
</span>            <span class="k">return</span> <span class="mf">62.92</span>      \
                <span class="o">+</span> <span class="p">(</span> <span class="mf">0.32217</span>   \
                <span class="o">+</span> <span class="p">(</span> <span class="mf">0.005589</span><span class="p">)</span> \
                <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_until_2150</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 2050 &lt;= year and year &lt;= 2150

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span> <span class="mi">20</span> \
               <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1820</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> \
               <span class="o">-</span> <span class="mf">0.5628</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2150</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">__dt_after_2150</span><span class="p">(</span><span class="n">utc</span><span class="p">):</span>
    <span class="s">""" 2150 &lt; year

    :param datetime utc: 協定世界時
    :return float    dt: ΔT
    """</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">utc</span><span class="p">.</span><span class="n">year</span> <span class="o">+</span> <span class="p">(</span><span class="n">utc</span><span class="p">.</span><span class="n">month</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1820</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">20</span> <span class="o">+</span> <span class="mi">32</span> <span class="o">*</span> <span class="n">t</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">utc2tai</span><span class="p">(</span><span class="n">utc</span><span class="p">,</span> <span class="n">utc_tai</span><span class="p">):</span>
    <span class="s">""" UTC(協定世界時) -&gt; TAI(国際原子時)
        * TAI = UTC - UTC_TAI

    :param  datetime     utc: 協定世界時
    :param  datetime utc_tai: 協定世界時と国際原子時の差(うるう秒の総和)
    :return datetime     tai: 国際原子時
    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">utc</span> <span class="o">-</span> <span class="n">datetime</span><span class="p">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">utc_tai</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">utc2ut1</span><span class="p">(</span><span class="n">utc</span><span class="p">,</span> <span class="n">dut1</span><span class="p">):</span>
    <span class="s">""" UTC(協定世界時) -&gt; UT1(世界時1)
        * UT1 = UTC + DUT1

    :param  datetime  utc: 協定世界時
    :param  datetime dut1: DUT1
    :return datetime  ut1: 世界時1
    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">utc</span> <span class="o">+</span> <span class="n">datetime</span><span class="p">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">dut1</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">tai2tt</span><span class="p">(</span><span class="n">tai</span><span class="p">):</span>
    <span class="s">""" TAI(協定世界時) -&gt; TT(地球時) 
        * TT = TAI + TT_TAI
             = UT1 + ΔT

    :param  datetime tai: 国際原子時
    :return datetime  tt: 地球時
    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tai</span> <span class="o">+</span> <span class="n">datetime</span><span class="p">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">TT_TAI</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">tt2tcg</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">jd</span><span class="p">):</span>
    <span class="s">""" TT(地球時) -&gt; TCG(地球重心座標時)
        * TCG = TT + L_G * (JD - T_0) * 86400
          （JD: ユリウス日,
            L_G = 6.969290134 * 10^(-10), T_0 = 2,443,144.5003725）

    :param  datetime  tt: 地球時
    :param  float     jd: ユリウス日
    :return datetime tcg: 地球重心座標時
    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">L_G</span> <span class="o">*</span> <span class="p">(</span><span class="n">jd</span> <span class="o">-</span> <span class="n">T_0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DAYSEC</span>
        <span class="k">return</span> <span class="n">tt</span> <span class="o">+</span> <span class="n">datetime</span><span class="p">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">tt2tcb</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">jd</span><span class="p">):</span>
    <span class="s">""" TT(地球時) -&gt; TCB(太陽系重心座標時)
        * TCB = TT + L_B * (JD - T_0) * 86400

    :param  datetime  tt: 地球時
    :param  float     jd: ユリウス日
    :return datetime tcb: 太陽系重心座標時
    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">L_B</span> <span class="o">*</span> <span class="p">(</span><span class="n">jd</span> <span class="o">-</span> <span class="n">T_0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DAYSEC</span>
        <span class="k">return</span> <span class="n">tt</span> <span class="o">+</span> <span class="n">datetime</span><span class="p">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>

<span class="k">def</span> <span class="nf">tcb2tdb</span><span class="p">(</span><span class="n">tcb</span><span class="p">,</span> <span class="n">jd_tcb</span><span class="p">):</span>
    <span class="s">""" TCB(太陽系重心座標時) -&gt; TDB(太陽系力学時)
        * TDB = TCB - L_B * (JD_TCB - T_0) * 86400 + TDB_0

    :param  datetime tcb: 太陽系重心座標時
    :param  float jd_tcb: ユリウス日 (for TCB)
    :return datetime tdb: 太陽系力学時
    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">L_B</span> <span class="o">*</span> <span class="p">(</span><span class="n">jd_tcb</span> <span class="o">-</span> <span class="n">T_0</span><span class="p">)</span> <span class="o">*</span> <span class="n">DAYSEC</span> <span class="o">-</span> <span class="n">TDB_0</span>
        <span class="k">return</span> <span class="n">tcb</span> <span class="o">-</span> <span class="n">datetime</span><span class="p">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li><a href="https://gist.github.com/komasaru/2186817d0814064dfc56dc34e0f6461e" title="Gist - Python script to convert time series.">Gist - Python script to convert time series.</a></li>
</ul>

<h3 id="3-python-スクリプトの実行">3. Python スクリプトの実行</h3>

<p>引数に JST（日本標準時; UTC + 9）で年月日 or 年月日時分秒を指定して実行。（引数無指定で、システム日時を JST と判断する）</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ./conv_time.py 20180630123456
      JST: 2018-06-30 12:34:56.000000
      UTC: 2018-06-30 03:34:56.000000
JST - UTC: 9 hours
       JD: 2458299.6492592595 days
        T: 0.1849322179 century (= Julian Century Number)
UTC - TAI: -37 seconds (= amount of leap seconds)
     DUT1: 0.0 seconds
  delta T: 69.184 seconds
      TAI: 2018-06-30 03:35:33.000000
      UT1: 2018-06-30 03:34:56.000000
       TT: 2018-06-30 03:36:05.184000
      TCG: 2018-06-30 03:36:06.096562
      TCB: 2018-06-30 03:36:25.486581
   JD_TCB: 2458299.6502893521 days
      TDB: 2018-06-30 03:36:05.183933
</code></pre></div></div>

<hr />

<p>特に、 TT, TDB, TCG, TCB あたりは天文学的な計算を行う際に必要になってきます。</p>

<p>以上。</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/python" class="page__taxonomy-item" rel="tag">Python</a><span class="sep">, </span>
    
      
      
      <a href="/tags/%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC" class="page__taxonomy-item" rel="tag">カレンダー</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0" class="page__taxonomy-item" rel="tag">プログラミング</a><span class="sep">, </span>
    
      
      
      <a href="/categories/%E6%9A%A6-%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC" class="page__taxonomy-item" rel="tag">暦・カレンダー</a>
    
    </span>
  </p>


        
          
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2018-07-23T00:20:00+09:00">2018-07-23 00:20</time></p>
        
        <br />
      </footer>
      <div id="google-ad-3"></div>
      <br />
      <br />
      <br />
      <br />

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=rsm_mzk&text=Python+-+%E5%90%84%E7%A8%AE%E6%99%82%E5%88%BB%E7%B3%BB%E3%81%AE%E5%A4%89%E6%8F%9B%EF%BC%81%20https%3A%2F%2Fkomasaru.github.io%2F2018%2F07%2F23%2Fpython-calc-time-series%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkomasaru.github.io%2F2018%2F07%2F23%2Fpython-calc-time-series%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  

  <a href="https://www.tumblr.com/share" class="btn btn--tumblr" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Tumblr"><i class="fab fa-fw fa-tumblr" aria-hidden="true"></i><span> Tumblr</span></a><script id="tumblr-js" async src="https://assets.tumblr.com/share-button.js"></script>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fkomasaru.github.io%2F2018%2F07%2F23%2Fpython-calc-time-series%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      <section>
        &nbsp;
        <h4>Sponsored Link</h4>
        <div id="rakuten-ad"></div>
        <div id="amazon-ad-1"></div>
      </section>
      &nbsp;
      
  <nav class="pagination">
    
      <a href="/2018/07/20/python-calc-greenwich-sidereal-time/" class="pagination--pager" title="Python - グリニッジ恒星時の計算（IAU2006 理論）！
">Previous</a>
    
    
      <a href="/2018/07/26/python-coordinate-conversion/" class="pagination--pager" title="Python - 赤道・黄道座標の変換！
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comments</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
    <div class="page__related">
      <div id="google-ad-4"></div>
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2022/11/09/cpp-matrix-lib-eigen/" rel="permalink">C++ - 行列ライブラリ Eigen 試用
</a>
        &nbsp;<small>(2022-11-09)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">C++ 用の行列（線形代数）ライブラリである Eigen の環境を構築し、試用してみました。

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2022/11/01/blog-access/" rel="permalink">2022年10月 - OS・ブラウザ別アクセス状況！
</a>
        &nbsp;<small>(2022-11-01)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">11月になりましたので、先月10月分の当ブログアクセス状況を公開します。（※自分用の記録）

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2022/10/12/ruby-logistic-regression/" rel="permalink">Ruby - ロジスティック回帰分析！
</a>
        &nbsp;<small>(2022-10-12)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">2か月ほど前、説明変数K個・目的変数1個のロジスティック回帰分析のアルゴリズムをプログラムとして実装できるようにするために自分なりに理解してまとめたものを紹介しました。


  ロジスティック回帰分析！


今回は、そのアルゴリズムを Ruby で実装してみました。（但し、行列計算では matrix ライブラリを...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2022/10/03/blog-access/" rel="permalink">2022年9月 - OS・ブラウザ別アクセス状況！
</a>
        &nbsp;<small>(2022-10-03)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">10月になりましたので、先月9月分の当ブログアクセス状況を公開します。（※自分用の記録）

</p>
  </article>
</div>

        
      </div>
      <!-- &nbsp;
      <div id="amazon-wd"></div -->
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form onsubmit="return googleCustomSearchExecute();" id="cse-search-box-form-id">
    <input type="text" id="cse-search-input-box-id" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    </form>
    <div id="results" class="results">
        <gcse:searchresults-only></gcse:searchresults-only>    
    </div></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<div id="qr"><img src="/assets/images/qr.png" alt="mk-mode BLOG"></div>
<div id="google-ad-5"></div>
<div class="page__footer-etc">
  <strong>ブログ開設日</strong> <tt>2009-01-05</tt><br />
  <strong>サーバ連続稼働時間</strong> <tt id="uptime">Loading...</tt><br />
  <strong>Page View</strong><br />
  &emsp;合計 <tt id="pv-total">Loading...</tt><br />
  &emsp;今日 <tt id="pv-today">Loading...</tt><br />
  &emsp;昨日 <tt id="pv-yesterday">Loading...</tt><br />
  <small>※<a href="/privacy.html" title="「プライバシーポリシー」ページへ">プライバシーポリシー</a></small>
</div>
<p id="page-top">
  <a href="#">
    <i class="fa fa-angle-double-up fa-2x" aria-hidden="true"></i>
  </a>
</p>
<!-- end custom footer snippets -->

        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/rsm_mzk" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
      
        
          <li><a href="https://github.com/komasaru" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="https://www.mk-mode.com/blog/atom.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 mk-mode.com. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script defer src="/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.6.0/js/all.js" integrity="sha384-z9ZOvGHHo21RqN5De4rfJMoAxYpaVoiYhuJXPyVmSs8yn20IE3PmBM534CffwSJI" crossorigin="anonymous"></script>
  <script defer src="/assets/js/my_custom.js"></script>


<script>
  (function () {
    var cx = 'partner-pub-7320193476057758:6328726109';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();

  function googleCustomSearchExecute() {
    var input = document.getElementById('cse-search-input-box-id');
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (input.value == '') {
      element.clearAllResults();
    } else {
      element.execute(input.value);
    }
    return false;
  }

  
</script>




  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18154748-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>





    
  <script>
    var disqus_config = function () {
      this.page.url = "https://komasaru.github.io/2018/07/23/python-calc-time-series/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/2018/07/23/python-calc-time-series"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://mkmodeblog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  



  </body>
</html>
