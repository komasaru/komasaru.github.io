<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="https://komasaru.github.io/atom.xml" rel="self" type="application/atom+xml" /><link href="https://komasaru.github.io/" rel="alternate" type="text/html" /><updated>2022-04-05T22:28:38+09:00</updated><id>https://komasaru.github.io/atom.xml</id><title type="html">mk-mode BLOG</title><subtitle>このブログは自宅サーバ(Debian GNU/Linux)で運用してしている&lt;a href=&quot;https://www.mk-mode.com/blog/&quot;&gt;ブログ&lt;/a&gt;のクローンです。&lt;br /&gt;PC・サーバ構築等の話題を中心に公開しております。</subtitle><author><name>mk-mode.com</name></author><entry><title type="html">Debian 11 (bullseye) - サーバ監視ツール munin 導入！</title><link href="https://komasaru.github.io/2022/04/06/debian-11-munin-installation/" rel="alternate" type="text/html" title="Debian 11 (bullseye) - サーバ監視ツール munin 導入！" /><published>2022-04-06T00:20:00+09:00</published><updated>2022-04-06T00:20:00+09:00</updated><id>https://komasaru.github.io/2022/04/06/debian-11-munin-installation</id><content type="html" xml:base="https://komasaru.github.io/2022/04/06/debian-11-munin-installation/">&lt;p&gt;Debian GNU/Linux 11 (bullseye) にサーバ監視ツール munin をインストールする方法についての記録です。&lt;/p&gt;

&lt;p&gt;以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。&lt;br /&gt;
（当然ながら、興味がなければスルーしてください）&lt;/p&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;0-前提条件&quot;&gt;0. 前提条件&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Debian GNU/Linux 11.2.0 (bullseye; 64bit) での作業を想定。&lt;/li&gt;
  &lt;li&gt;Web サーバは Nginx を想定。&lt;/li&gt;
  &lt;li&gt;munin 用ディレクトリは &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/www/munin&lt;/code&gt; とする。&lt;/li&gt;
  &lt;li&gt;root ユーザでの作業を想定。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;1-munin-のインストール&quot;&gt;1. munin のインストール&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# apt -y install munin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-設定ファイルの編集&quot;&gt;2. 設定ファイルの編集&lt;/h3&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/munin/munin.conf&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;dbdir   /var/lib/munin    &lt;span class=&quot;c&quot;&gt;# &amp;lt;= コメント解除&lt;/span&gt;
htmldir /var/www/munin    &lt;span class=&quot;c&quot;&gt;# &amp;lt;= コメント解除＆変更&lt;/span&gt;
logdir /var/log/munin     &lt;span class=&quot;c&quot;&gt;# &amp;lt;= コメント解除&lt;/span&gt;
rundir  /var/run/munin    &lt;span class=&quot;c&quot;&gt;# &amp;lt;= コメント解除&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#[localhost.localdomain]  # &amp;lt;= コメント化（変更したければ）&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;foo.mk-mode.com]        &lt;span class=&quot;c&quot;&gt;# &amp;lt;= 追加      （変更したければ）&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;3-ディレクトリの作成&quot;&gt;3. ディレクトリの作成&lt;/h3&gt;

&lt;p&gt;munin 用ディレクトリを所定の位置に作成する。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir -p /var/www/munin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;そして、所有者・所有グループを変更する。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chown -R munin:munin /var/www/munin/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;4-監視項目の確認&quot;&gt;4. 監視項目の確認&lt;/h3&gt;

&lt;p&gt;以下のようにして、監視項目を確認できる。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# munin-node-configure
Plugin                     | Used | Extra information
------                     | ---- | -----------------
acpi                       | no   |
amavis                     | no   |
apache_accesses            | no   |
         :
===&amp;lt; 途中省略 &amp;gt;===
         :
vserver_cpu_               | no   |
vserver_loadavg            | no   |
vserver_resources          | no   |
yum                        | no   |
zimbra_                    | no   |
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;5-web-サーバの設定&quot;&gt;5. Web サーバの設定&lt;/h3&gt;

&lt;p&gt;Web サーバに Nginx を使用する場合は、設定ファイルに以下のような記述を追加する。（&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;server&lt;/code&gt; ディレクティブ内に）&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/nginx/conf.d/default.conf&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;server &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    location /munin &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;alias&lt;/span&gt; /var/www/munin&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        index index.html index.htm index&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        allow 127.0.0.1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        allow 192.168.11.0/24&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        deny  all&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;6-web-サーバの再起動&quot;&gt;6. Web サーバの再起動&lt;/h3&gt;

&lt;p&gt;設定を有効化するために Web サーバ Nginx を再起動する。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl restart nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;7-munin-node-の再起動&quot;&gt;7. munin-node の再起動&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl restart munin-node
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;8-自動実行の設定&quot;&gt;8. 自動実行の設定&lt;/h3&gt;

&lt;p&gt;デフォルトで自動起動するようになっているが、なっていなければ設定する。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl enable munin-node
Synchronizing state of munin-node.service with SysV service script with /lib/systemd/systemd-sysv-install.
Executing: /lib/systemd/systemd-sysv-install enable munin-node
insserv: warning: current start runlevel(s) (empty) of script `munin-node&apos; overrides LSB defaults (2 3 4 5).
insserv: warning: current stop runlevel(s) (0 1 2 3 4 5 6) of script `munin-node&apos; overrides LSB defaults (0 1 6).

# systemctl is-enabled munin-node
enabled
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;9-動作確認&quot;&gt;9. 動作確認&lt;/h3&gt;

&lt;p&gt;５分ほど経過してから、ブラウザで &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://＜Webサーバのホスト名 or IP アドレス＞/munin&lt;/code&gt; にアクセスし、表示されることを確認する。&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;以上。&lt;/p&gt;</content><author><name>mk-mode.com</name></author><category term="サーバ構築" /><category term="Debian" /><category term="Linux" /><category term="munin" /><summary type="html">Debian GNU/Linux 11 (bullseye) にサーバ監視ツール munin をインストールする方法についての記録です。 以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。 （当然ながら、興味がなければスルーしてください）</summary></entry><entry><title type="html">2022年3月 - OS・ブラウザ別アクセス状況！</title><link href="https://komasaru.github.io/2022/04/01/blog-access/" rel="alternate" type="text/html" title="2022年3月 - OS・ブラウザ別アクセス状況！" /><published>2022-04-01T00:20:00+09:00</published><updated>2022-04-01T00:20:00+09:00</updated><id>https://komasaru.github.io/2022/04/01/blog-access</id><content type="html" xml:base="https://komasaru.github.io/2022/04/01/blog-access/">&lt;p&gt;4月になりましたので、先月3月分の当ブログアクセス状況を公開します。（※自分用の記録）&lt;/p&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;1-アクセスをos別に集計&quot;&gt;1. アクセスをOS別に集計&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;OS&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;PageViews&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;比率(%)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;20,632&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;67.9534&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mac OS&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;6,864&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;22.6072&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1,367&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;4.5023&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Android&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;986&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3.2475&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ubuntu Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;310&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.0210&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;155&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.5105&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Fedora Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;36&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.1186&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FreeBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;10&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0329&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;OpenBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0033&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Wii&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0033&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;tfoot&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;合　計&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;30,362&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;100.0000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tfoot&gt;
&lt;/table&gt;

&lt;h3 id=&quot;2-アクセスをosバージョン別に集計&quot;&gt;2. アクセスをOS・バージョン別に集計&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;OS&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Version&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;PageViews&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;比率(%)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;16,473&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;54.2553&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mac OS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;X&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;6,864&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;22.6072&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;7&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3,831&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;12.6177&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1,367&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;4.5023&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Android&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;986&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3.2475&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ubuntu Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;310&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.0210&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;8.1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;262&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.8629&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;155&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.5105&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Fedora Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;36&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.1186&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;XP&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;30&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0988&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;NT&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;15&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0494&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;8&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;14&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0461&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FreeBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;10&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0329&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0165&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Server 2003&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0066&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;OpenBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0033&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Wii&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0033&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;tfoot&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;合　計&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;30,362&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;100.0000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tfoot&gt;
&lt;/table&gt;

&lt;h3 id=&quot;3-アクセスをブラウザ別に集計&quot;&gt;3. アクセスをブラウザ別に集計&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;ブラウザ&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;PageViews&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;比率(%)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;19,434&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;64.0076&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Safari&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3,809&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;12.5453&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Netscape Navigator&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3,661&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;12.0578&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mozilla Firefox&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3,006&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;9.9005&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Internet Explorer&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;432&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.4228&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mozilla SeaMonkey&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;8&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0263&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Opera&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;7&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0231&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;4&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0132&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Epiphany&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0033&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;tfoot&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;合　計&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;30,362&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;100.0000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tfoot&gt;
&lt;/table&gt;

&lt;h3 id=&quot;4-アクセスをブラウザバージョン別に集計上位20件&quot;&gt;4. アクセスをブラウザ・バージョン別に集計（上位20件）&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;ブラウザ&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Version&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;PageViews&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;比率(%)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;99.0.4844.51&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;6,402&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;21.0856&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Netscape Navigator&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;5.0&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3,661&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;12.0578&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0.4758.102&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3,447&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;11.3530&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;99.0.4844.74&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2,730&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;8.9915&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;99.0.4844.82&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1,887&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;6.2150&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Safari&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9537.53&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1,494&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;4.9206&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Safari&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;604.1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1,455&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;4.7922&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mozilla Firefox&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1,308&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;4.3080&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;99.0.4844.84&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;900&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2.9642&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mozilla Firefox&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;97.0&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;853&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2.8094&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Safari&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;605.1.15&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;833&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2.7436&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0.4758.109&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;618&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2.0354&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;99.0.4844.83&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;481&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.5842&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mozilla Firefox&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;91.0&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;466&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.5348&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Internet Explorer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;11.0&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;409&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.3471&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0.4758.80&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;266&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.8761&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;99.0.4844.58&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;241&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.7938&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;99.0.4844.73&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;238&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.7839&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0.4758.101&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;228&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.7509&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;97.0.4692.99&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;149&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.4907&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;：&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;：&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;：&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;：&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;tfoot&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;合　計&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;30,362&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;100.0000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tfoot&gt;
&lt;/table&gt;

&lt;hr /&gt;

&lt;p&gt;以上。&lt;/p&gt;</content><author><name>mk-mode.com</name></author><category term="ブログ" /><category term="Jekyll" /><summary type="html">4月になりましたので、先月3月分の当ブログアクセス状況を公開します。（※自分用の記録）</summary></entry><entry><title type="html">Debian 11 (bullseye) - PHP インストール（Nginx と連携）！</title><link href="https://komasaru.github.io/2022/03/30/debian-11-php-installation-by-src-with-nginx-cooperation/" rel="alternate" type="text/html" title="Debian 11 (bullseye) - PHP インストール（Nginx と連携）！" /><published>2022-03-30T00:20:00+09:00</published><updated>2022-03-30T00:20:00+09:00</updated><id>https://komasaru.github.io/2022/03/30/debian-11-php-installation-by-src-with-nginx-cooperation</id><content type="html" xml:base="https://komasaru.github.io/2022/03/30/debian-11-php-installation-by-src-with-nginx-cooperation/">&lt;p&gt;Debian GNU/Linux 11 (bullseye) に PHP をソースをビルドしてインストールし、 Web／リバースプロキシサーバ Nginx と連携する方法についての記録です。&lt;/p&gt;

&lt;p&gt;以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。&lt;br /&gt;
（当然ながら、興味がなければスルーしてください）&lt;/p&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;0-前提条件&quot;&gt;0. 前提条件&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Debian GNU/Linux 11.2.0 (bullseye; 64bit) での作業を想定。&lt;/li&gt;
  &lt;li&gt;サーバ用途なので、作業は基本的に全て一般ユーザから root になって行う。&lt;/li&gt;
  &lt;li&gt;クライアント側も Debian GNU/Linux 11 (bullseye; 64bit) を想定。&lt;/li&gt;
  &lt;li&gt;Web サーバとして Apache2 でなく Nginx と連携させることを想定しているので、 Nginx がインストール済みであること。（参照： &lt;a href=&quot;/2022/02/02/debian-11-nginx-installation-by-official-apt&quot; title=&quot;Debian 11 (bullseye) - Web サーバ Nginx 構築（Nginx 公式リポジトリ使用）！&quot;&gt;Debian 11 (bullseye) - Web サーバ Nginx 構築（Nginx 公式リポジトリ使用）！&lt;/a&gt;）&lt;/li&gt;
  &lt;li&gt;標準リポジトリから PHP 7.4 系をインストールする。&lt;/li&gt;
  &lt;li&gt;root ユーザでの作業を想定。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;1--php-のインストール&quot;&gt;1.  PHP のインストール&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# apt -y install php php-cgi php-fpm php-common php-pear php-mbstring
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-インストールの確認&quot;&gt;2. インストールの確認&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# php -v
PHP 7.4.21 (cli) (built: Jul  2 2021 03:59:48) ( NTS )
Copyright (c) The PHP Group
Zend Engine v3.4.0, Copyright (c) Zend Technologies
    with Zend OPcache v7.4.21, Copyright (c), by Zend Technologies
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;3-php-fpm-設定ファイルの編集&quot;&gt;3. php-fpm 設定ファイルの編集&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;group&lt;/code&gt; 等を Nginx と同じものに編集する。&lt;br /&gt;
ついでに、ソケットファイルの設定も確認しておく。&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/php/7.4/fpm/pool.d/www.conf&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;user &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; nginx              &lt;span class=&quot;c&quot;&gt;# &amp;lt;= www-data から変更&lt;/span&gt;
group &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; nginx             &lt;span class=&quot;c&quot;&gt;# &amp;lt;= www-data から変更&lt;/span&gt;

listen.owner &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; nginx      &lt;span class=&quot;c&quot;&gt;# &amp;lt;= www-data から変更&lt;/span&gt;
listen.group &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; nginx      &lt;span class=&quot;c&quot;&gt;# &amp;lt;= www-data から変更&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;4-php-設定ファイルの編集&quot;&gt;4. PHP 設定ファイルの編集&lt;/h3&gt;

&lt;p&gt;タイムゾーンを設定する。（日本時間）&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/php/7.4/fpm/php.ini&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Date]
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; Defines the default timezone used by the &lt;span class=&quot;nb&quot;&gt;date &lt;/span&gt;functions
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; http://php.net/date.timezone
&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;date.timezone &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
date.timezone &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Asia/Tokyo  // &amp;lt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 追加&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;5-nginx-設定ファイルの編集&quot;&gt;5. Nginx 設定ファイルの編集&lt;/h3&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/nginx/conf.d/default.conf&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;location ~ &lt;span class=&quot;se&quot;&gt;\.&lt;/span&gt;php&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    root          html&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    fastcgi_pass  unix:/run/php/php7.4-fpm.sock&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    fastcgi_index index.php&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    fastcgi_param SCRIPT_FILENAME  /var/www/html&lt;span class=&quot;nv&quot;&gt;$fastcgi_script_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    fastcgi_pass_header &lt;span class=&quot;s2&quot;&gt;&quot;X-Accel-Redirect&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    fastcgi_pass_header &lt;span class=&quot;s2&quot;&gt;&quot;X-Accel-Buffering&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    fastcgi_pass_header &lt;span class=&quot;s2&quot;&gt;&quot;X-Accel-Charset&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    fastcgi_pass_header &lt;span class=&quot;s2&quot;&gt;&quot;X-Accel-Expires&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    fastcgi_pass_header &lt;span class=&quot;s2&quot;&gt;&quot;X-Accel-Limit-Rate&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    include fastcgi_params&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;6-表示テスト用-php-ソースの作成&quot;&gt;6. 表示テスト用 PHP ソースの作成&lt;/h3&gt;

&lt;p&gt;ドキュメントルートへ以下のような内容の &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phpinfo.php&lt;/code&gt; を作成する。&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;phpinfo.php&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;phpinfo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;7-サービスの再起動&quot;&gt;7. サービスの再起動&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl restart nginx
# systemctl restart php7.4-fpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;8-動作確認&quot;&gt;8. 動作確認&lt;/h3&gt;

&lt;p&gt;プラウザで &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;http://＜サーバアドレス＞/phpinfo.php&lt;/code&gt; にアクセスしてみて、 PHP 情報ページが表示されればよい。&lt;/p&gt;

&lt;h3 id=&quot;9-参考サイト&quot;&gt;9. 参考サイト&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://jp2.php.net/manual/ja/install.unix.php&quot; title=&quot;PHP: Unix システムへのインストール - Manual&quot;&gt;PHP: Unix システムへのインストール - Manual&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;以上。&lt;/p&gt;</content><author><name>mk-mode.com</name></author><category term="サーバ構築" /><category term="Debian" /><category term="Linux" /><category term="PHP" /><category term="Nginx" /><summary type="html">Debian GNU/Linux 11 (bullseye) に PHP をソースをビルドしてインストールし、 Web／リバースプロキシサーバ Nginx と連携する方法についての記録です。 以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。 （当然ながら、興味がなければスルーしてください）</summary></entry><entry><title type="html">Debian 11 (bullseye) - Git インストール（ソースビルド）！</title><link href="https://komasaru.github.io/2022/03/23/debian-11-git-installation-by-src/" rel="alternate" type="text/html" title="Debian 11 (bullseye) - Git インストール（ソースビルド）！" /><published>2022-03-23T00:20:00+09:00</published><updated>2022-03-23T00:20:00+09:00</updated><id>https://komasaru.github.io/2022/03/23/debian-11-git-installation-by-src</id><content type="html" xml:base="https://komasaru.github.io/2022/03/23/debian-11-git-installation-by-src/">&lt;p&gt;Debian GNU/Linux 11 (bullseye) に Git サーバをソースをビルドしてインストールする方法についての記録です。&lt;/p&gt;

&lt;p&gt;以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。&lt;br /&gt;
（当然ながら、興味がなければスルーしてください）&lt;/p&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;0-前提条件&quot;&gt;0. 前提条件&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Debian GNU/Linux 11.2.0 (bullseye; 64bit) での作業を想定。&lt;/li&gt;
  &lt;li&gt;Git 2.33.0 （当記事執筆時点で最新）を Git サーバとしてインストールすることを想定。&lt;/li&gt;
  &lt;li&gt;アーカイブ保存先は &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/src&lt;/code&gt; を想定。&lt;/li&gt;
  &lt;li&gt;インストール先は &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local&lt;/code&gt; を想定。&lt;/li&gt;
  &lt;li&gt;クライアントからアクセスがあった時だけサーバを起動するために xinetd を使用する。&lt;/li&gt;
  &lt;li&gt;ドキュメント(doc, html, info)はインストールしない。&lt;/li&gt;
  &lt;li&gt;root ユーザでの作業を想定。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;1-依存パッケージのインストール&quot;&gt;1. 依存パッケージのインストール&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# apt -y install xinetd libcurl4-gnutls-dev libexpat1-dev \
gettext libz-dev libssl-dev
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-アーカイブファイルの取得展開&quot;&gt;2. アーカイブファイルの取得＆展開&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cd /usr/local/src
# wget https://www.kernel.org/pub/software/scm/git/git-2.33.0.tar.gz
# tar xvf git-2.33.0.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ちなみに、最新版のソースを使用したければ、以下のように取得すればよい。（既インストールの git を使用して）&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# git clone https://github.com/git/git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;3-ビルドインストール&quot;&gt;3. ビルド＆インストール&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cd git-2.33.0
# make configure
# ./configure --prefix=/usr/local
# make
# make install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;4-インストールの確認&quot;&gt;4. インストールの確認&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# git --version
git version 2.33.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;5-xinetd-設定ファイルの作成&quot;&gt;5. xinetd 設定ファイルの作成&lt;/h3&gt;

&lt;p&gt;デフォルトでは存在しないので作成する。&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/xinetd.d/git&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;service git
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        disable         &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; no
        socket_type     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; stream
        &lt;span class=&quot;nb&quot;&gt;wait&lt;/span&gt;            &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; no
        user            &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; nobody
        server          &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; /usr/local/libexec/git-core/git-daemon
        server_args     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--base-path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/lib/git &lt;span class=&quot;nt&quot;&gt;--export-all&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--user-path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;public_git &lt;span class=&quot;nt&quot;&gt;--syslog&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--inetd&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--verbose&lt;/span&gt;
        log_on_failure  +&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; USERID
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;6-xinetd-の再起動&quot;&gt;6. Xinetd の再起動&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl restart xinetd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;7-リポジトリの作成&quot;&gt;7. リポジトリの作成&lt;/h3&gt;

&lt;p&gt;作成先は &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/xinetd.d/git&lt;/code&gt; の &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--base-path&lt;/code&gt; で指定している &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/lib/git/&lt;/code&gt; とした。（以下は &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;test.git&lt;/code&gt; という Git リポジトリを作成する例）&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cd /var/lib/
# mkdir -p git/public_git
# cd git/public_git
# git --bare init --shared test.git
Initialized empty shared Git repository in /var/lib/git/public_git/test.git/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;8-git-用グループの作成&quot;&gt;8. Git 用グループの作成&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# groupadd git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;9-権限の変更&quot;&gt;9. 権限の変更&lt;/h3&gt;

&lt;p&gt;リポジトリの所有者・所有グループを変更する。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chown -R root:git test.git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;10-リポジトリのディレクトリを確認&quot;&gt;10. リポジトリのディレクトリを確認&lt;/h3&gt;

&lt;p&gt;現状のリポジトリ内を確認してみる。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -l
合計 32
-rw-rw-r-- 1 root git   23 10月  2 12:05 HEAD
drwxrwsr-x 2 root git 4096 10月  2 12:05 branches
-rw-rw-r-- 1 root git  126 10月  2 12:05 config
-rw-rw-r-- 1 root git   73 10月  2 12:05 description
drwxrwsr-x 2 root git 4096 10月  2 12:05 hooks
drwxrwsr-x 2 root git 4096 10月  2 12:05 info
drwxrwsr-x 4 root git 4096 10月  2 12:05 objects
drwxrwsr-x 4 root git 4096 10月  2 12:05 refs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;11-動作確認&quot;&gt;11. 動作確認&lt;/h3&gt;

&lt;p&gt;ここではクライアント側からの操作について説明はしないが、各種作業を行い問題がないことを確認しておく。&lt;br /&gt;
(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git status&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git add&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git clone&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git push&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;git pull&lt;/code&gt; etc.)&lt;/p&gt;

&lt;h3 id=&quot;12-参考サイト&quot;&gt;12. 参考サイト&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://git-scm.com/downloads&quot; title=&quot;Git - Downloads&quot;&gt;Git - Downloads&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://git-scm.com/book/en/v2/Getting-Started-Installing-Git&quot; title=&quot;Git - Installing Git &quot;&gt;Git - Installing Git &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;以上。&lt;/p&gt;</content><author><name>mk-mode.com</name></author><category term="サーバ構築" /><category term="Debian" /><category term="Linux" /><category term="Git" /><summary type="html">Debian GNU/Linux 11 (bullseye) に Git サーバをソースをビルドしてインストールする方法についての記録です。 以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。 （当然ながら、興味がなければスルーしてください）</summary></entry><entry><title type="html">Debian 11 (bullseye) - 自動バックアップ運用！</title><link href="https://komasaru.github.io/2022/03/16/debian-11-automatic-backup-setting/" rel="alternate" type="text/html" title="Debian 11 (bullseye) - 自動バックアップ運用！" /><published>2022-03-16T00:20:00+09:00</published><updated>2022-03-16T00:20:00+09:00</updated><id>https://komasaru.github.io/2022/03/16/debian-11-automatic-backup-setting</id><content type="html" xml:base="https://komasaru.github.io/2022/03/16/debian-11-automatic-backup-setting/">&lt;p&gt;Debian GNU/Linux 11 (bullseye) で自動バックアップ運用する方法についての記録です。&lt;/p&gt;

&lt;p&gt;以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。&lt;br /&gt;
（当然ながら、興味がなければスルーしてください）&lt;/p&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;0-前提条件&quot;&gt;0. 前提条件&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Debian GNU/Linux 11.2.0 (bullseye; 64bit) での作業を想定。&lt;/li&gt;
  &lt;li&gt;バックファイルを配置するディレクトリは &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/home/foo/bak&lt;/code&gt; （foo ユーザのホーム内の &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bak&lt;/code&gt; ディレクトリ）とする。&lt;/li&gt;
  &lt;li&gt;root ユーザでの作業を想定。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;1-バックアップスクリプトの作成&quot;&gt;1. バックアップスクリプトの作成&lt;/h3&gt;

&lt;p&gt;以下のような内容でバックアップスクリプトを作成する。&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/root/backup.sh&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ローカル内でバックアップ&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;LANG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;C

&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 設定開始&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# バックアップ対象リスト名&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ※バックアップ対象をフルパスで記述したリスト&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;BACKUPLIST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/root/backuplist
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPLIST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BACKUPLIST&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; is not found&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; error_exit

&lt;span class=&quot;c&quot;&gt;# バックアップ対象外リスト名&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ※バックアップ対象外をフルパスで記述したリスト&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;BACKUPNOLIST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/root/backupnolist

&lt;span class=&quot;c&quot;&gt;# バックアップ先ディレクトリ名&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;BACKUPDIR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/home/foo/bak
&lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# バックアップ保存世代数&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ※当日分を含めた過去分バックアップを保存する世代数&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ※過去分バックアップを保存しない場合は1を指定する&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;BACKUPGEN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;8

&lt;span class=&quot;c&quot;&gt;# 暗号化・復号化パスフレーズ&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ※指定がないときは暗号化しない&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;PASS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;&apos;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# バックアップログファイル名&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;BACKUPLOG&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/var/log/backup.log

&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 設定終了&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 異常終了処理関数定義&lt;/span&gt;
error_exit &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$TMPBACKUPNOLIST&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;exit &lt;/span&gt;1
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# バックアップファイルをバックアップ対象外リストに追加&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ※バックアップ先ファイルをバックアップしないようにする&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;TMPBACKUPNOLIST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mktemp&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPNOLIST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPNOLIST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$TMPBACKUPNOLIST&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/*backup.tar.bz2&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$TMPBACKUPNOLIST&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# 前回バックアップをリネーム&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;OLDBACKUPFILE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls &lt;/span&gt;backup.tar.bz2&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; 2&amp;gt;/dev/null&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$OLDBACKUPFILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TIMESTAMP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--full-time&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$OLDBACKUPFILE&lt;/span&gt;|awk &lt;span class=&quot;s1&quot;&gt;&apos;{print $6}&apos;&lt;/span&gt;|tr &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; -&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;/&lt;span class=&quot;nv&quot;&gt;$OLDBACKUPFILE&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;/&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TIMESTAMP&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$OLDBACKUPFILE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /dev/null 2&amp;gt;&amp;amp;1
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# バックアップログファイル作成&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPLOG&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;touch&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPLOG&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;400 &lt;span class=&quot;nv&quot;&gt;$BACKUPLOG&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# バックアップ実行&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; backup start&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPLOG&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -X オプションが効かない =&amp;gt; 削除&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#tar cjvfP $BACKUPDIR/backup.tar.bz2 -T $BACKUPLIST -X $TMPBACKUPNOLIST &amp;gt;&amp;gt; $BACKUPLOG 2&amp;gt;&amp;amp;1&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;tar &lt;/span&gt;cjvfP &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;/backup.tar.bz2 &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPLIST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPLOG&lt;/span&gt; 2&amp;gt;&amp;amp;1
&lt;span class=&quot;nv&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$code&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ne&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPLOG&lt;/span&gt; | mail &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;BACKUP NG CODE IS &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$code&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; root
    &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;/backup.tar.bz2
    error_exit
&lt;span class=&quot;k&quot;&gt;fi
&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; backup end&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPLOG&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# バックアップ暗号化(暗号化・復号化パスフレーズ指定時のみ)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-z&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$PASS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; encrypt start&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPLOG&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$HOME&lt;/span&gt;/.gnupg
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$PASS&lt;/span&gt;|gpg &lt;span class=&quot;nt&quot;&gt;--passphrase-fd&lt;/span&gt; 0 &lt;span class=&quot;nt&quot;&gt;--batch&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;/backup.tar.bz2 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /dev/null 2&amp;gt;&amp;amp;1
    &lt;span class=&quot;nv&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$?&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$code&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ne&lt;/span&gt; 0 &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPLOG&lt;/span&gt; | mail &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;BACKUP NG CODE IS &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$code&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; root
        &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;/backup.tar.bz2&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
        error_exit
    &lt;span class=&quot;k&quot;&gt;fi
    &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;/backup.tar.bz2
    &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; encrypt end&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPLOG&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# バックアップ保存世代を超えた古いバックアップを削除&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;backup.tar.bz2&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;|wc &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-gt&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPGEN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;OLDBACKUPCNT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;expr&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;backup.tar.bz2&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;|wc &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;nv&quot;&gt;$BACKUPGEN&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;file &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$BACKUPDIR&lt;/span&gt;/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;backup.tar.bz2&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;|tail &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$OLDBACKUPCNT&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;do
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$file&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;done
fi&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# バックアップ対象外リスト削除&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$TMPBACKUPNOLIST&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;2-実行権限の付与&quot;&gt;2. 実行権限の付与&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chmod +x backup.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;3-バックアップ対象リストの作成&quot;&gt;3. バックアップ対象リストの作成&lt;/h3&gt;

&lt;p&gt;バックアップするディレクトリやファイルを一覧にしたファイル &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;backuplist&lt;/code&gt; を以下のように作成する。（以下は単なる一例。内容は適宜編集すること。そして、最終行で改行しないこと）&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/root/backuplist&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/home
/root
/var/www
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;4-バックアップ対象外リストの作成&quot;&gt;4. バックアップ対象外リストの作成&lt;/h3&gt;

&lt;p&gt;バックアップ対象のディレクトリやファイルの中でもバックアップしたくないディレクトリやファイルを一覧にしたファイル &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;backupnolist&lt;/code&gt; を以下のように作成する。（以下は単なる一例。内容は適宜編集すること。そして、最終行で改行しないこと。また、対象外にするディレクトリやファイルが無ければ作成しなくてよい）&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/root/backupnolist&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/home/hoge
/var/www/fuga
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;5-バックアップの実行&quot;&gt;5. バックアップの実行&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ./backup.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;バックアップディレクトリにアーカイブファイルが作成されるはずである。&lt;br /&gt;
また、ファイルが増えれば最大８世代残すようになっている。（そういうスクリプトにしているから）（以下は、8日経過後の様子）&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -l /home/bak/
total 522
-rw-r--r-- 1 root root     84205 Jun 30 03:01 20150430backup.tar.bz2
-rw-r--r-- 1 root root     84276 Jul  1 03:01 20150501backup.tar.bz2
-rw-r--r-- 1 root root     84336 Jul  2 03:01 20150502backup.tar.bz2
-rw-r--r-- 1 root root     84133 Jul  3 03:01 20150503backup.tar.bz2
-rw-r--r-- 1 root root     84140 Jul  4 03:01 20150504backup.tar.bz2
-rw-r--r-- 1 root root     84029 Jul  5 03:01 20150505backup.tar.bz2
-rw-r--r-- 1 root root     84124 Jul  6 03:01 20150506backup.tar.bz2
-rw-r--r-- 1 root root     84128 Jul  7 03:01 backup.tar.bz2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;6-自動実行の設定&quot;&gt;6. 自動実行の設定&lt;/h3&gt;

&lt;p&gt;毎日定時に実行するよう cron 登録する。（&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/cron.d/backup&lt;/code&gt; を以下の内容で作成する）&lt;br /&gt;
以下は毎日午前3時1分にバックアップスクリプトを実行する例。&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/cron.d/backup&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;1 3 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; root /root/backup.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;7-参考サイト&quot;&gt;7. 参考サイト&lt;/h3&gt;

&lt;p&gt;CentOS での自動バックアップ運用を参考にしている（流用している）。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://centossrv.com/backup.shtml&quot; title=&quot;自動バックアップ運用(tar+GnuPG+rsync/ftp) - CentOSで自宅サーバー構築&quot;&gt;自動バックアップ運用(tar+GnuPG+rsync/ftp) - CentOSで自宅サーバー構築&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;以上。&lt;/p&gt;</content><author><name>mk-mode.com</name></author><category term="サーバ構築" /><category term="Debian" /><category term="Linux" /><summary type="html">Debian GNU/Linux 11 (bullseye) で自動バックアップ運用する方法についての記録です。 以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。 （当然ながら、興味がなければスルーしてください）</summary></entry><entry><title type="html">Debian 11 (bullseye) - ログ解析ツール logwatch インストール！</title><link href="https://komasaru.github.io/2022/03/12/debian-11-logwatch-installation/" rel="alternate" type="text/html" title="Debian 11 (bullseye) - ログ解析ツール logwatch インストール！" /><published>2022-03-12T00:20:00+09:00</published><updated>2022-03-12T00:20:00+09:00</updated><id>https://komasaru.github.io/2022/03/12/debian-11-logwatch-installation</id><content type="html" xml:base="https://komasaru.github.io/2022/03/12/debian-11-logwatch-installation/">&lt;p&gt;Debian GNU/Linux 11 (bullseye) にログ監視ツール LogWatch をインストールする方法についての記録です。&lt;/p&gt;

&lt;p&gt;以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。&lt;br /&gt;
（当然ながら、興味がなければスルーしてください）&lt;/p&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;0-前提条件&quot;&gt;0. 前提条件&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Debian GNU/Linux 11 (bullseye; 64bit) での作業を想定。&lt;/li&gt;
  &lt;li&gt;root ユーザでの作業を想定。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;1-logwatch-のインストール&quot;&gt;1. logwatch のインストール&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# apt -y install logwatch
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-logwatch-設定ファイルの編集&quot;&gt;2. logwatch 設定ファイルの編集&lt;/h3&gt;

&lt;p&gt;まず、デフォルトの設定ファイルを複製する。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cp /usr/share/logwatch/default.conf/logwatch.conf /etc/logwatch/conf/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;デフォルトの設定で充分であるが、必要なら編集する。&lt;br /&gt;
メールの送信先等を変更するなら以下のようにする。&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/logwatch/conf/logwatch.conf&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;MailTo &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; hoge@xxxx.com  &lt;span class=&quot;c&quot;&gt;# &amp;lt; = メール送信先&lt;/span&gt;
Detail &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; High           &lt;span class=&quot;c&quot;&gt;# &amp;lt; = ログの詳細レベル (Low(0), Med(5), High(10) か 1～10 の整数)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;3-ディレクトリの作成&quot;&gt;3. ディレクトリの作成&lt;/h3&gt;

&lt;p&gt;キャッシュで使用するディレクトリが無いので作成しておく。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir /var/cache/logwatch
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;4-動作確認&quot;&gt;4. 動作確認&lt;/h3&gt;

&lt;p&gt;logwatch をインストールするとデフォルトで cron 登録されるので、毎日レポートメールが届くはずである。後はそのメール内容をチェックする。&lt;br /&gt;
今すぐに確認したければ、以下のようにする。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# /etc/cron.daily/00logwatch
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;以下のような内容のメールが届くはずである。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
 ################### Logwatch 7.5.5 (01/22/21) ####################
        Processing Initiated: Sun Sep 19 16:15:39 2021
        Date Range Processed: yesterday
                              ( 2021-Sep-18 )
                              Period is day.
        Detail Level of Output: 0
        Type of Output/Format: mail / text
        Logfiles for Host: vbox
 ##################################################################

         :
====&amp;lt; 以下省略 &amp;gt;====
         :
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;以上。&lt;/p&gt;</content><author><name>mk-mode.com</name></author><category term="サーバ構築" /><category term="Debian" /><category term="Linux" /><summary type="html">Debian GNU/Linux 11 (bullseye) にログ監視ツール LogWatch をインストールする方法についての記録です。 以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。 （当然ながら、興味がなければスルーしてください）</summary></entry><entry><title type="html">Debian 11 (bullseye) - Python 3.9 インストール（ソースビルド）！</title><link href="https://komasaru.github.io/2022/03/02/debian-11-python-3-9-installation-by-src/" rel="alternate" type="text/html" title="Debian 11 (bullseye) - Python 3.9 インストール（ソースビルド）！" /><published>2022-03-02T00:20:00+09:00</published><updated>2022-03-02T00:20:00+09:00</updated><id>https://komasaru.github.io/2022/03/02/debian-11-python-3-9-installation-by-src</id><content type="html" xml:base="https://komasaru.github.io/2022/03/02/debian-11-python-3-9-installation-by-src/">&lt;p&gt;Debian GNU/Linux 11 (bullseye) に Python 3.9 をソースをビルドしてインストールする方法についての記録です。&lt;/p&gt;

&lt;p&gt;以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。&lt;br /&gt;
（当然ながら、興味がなければスルーしてください）&lt;/p&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;0-前提条件&quot;&gt;0. 前提条件&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Debian GNU/Linux 11.0.0 (bullseye; 64bit) での作業を想定。&lt;/li&gt;
  &lt;li&gt;クライアント側も Debian GNU/Linux 11 (bullseye; 64bit) を想定。&lt;/li&gt;
  &lt;li&gt;当作業時で最新の 3.9.7 をソースをビルドしてインストールする。&lt;/li&gt;
  &lt;li&gt;デフォルトでインストールされている 3.9.2 はアンインストールしない。&lt;br /&gt;
（既にインストール・設定済みのパッケージに影響がでないよう）&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;1-python-のバージョン確認&quot;&gt;1. Python のバージョン確認&lt;/h3&gt;

&lt;p&gt;インストール済み（現状）の Python のバージョンを確認してみる。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# python3 -V
Python 3.9.2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--version&lt;/code&gt; オプションでもよい。&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;python3&lt;/code&gt; は &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;python3.9&lt;/code&gt; でもよい。&lt;br /&gt;
（&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;python3&lt;/code&gt; は &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;python3.9&lt;/code&gt; にシンボリックリンクが張られているので）&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;2-必要パッケージのインストール&quot;&gt;2. 必要パッケージのインストール&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# apt -y update
# apt -y install build-essential libbz2-dev libdb-dev \
  libreadline-dev libffi-dev libgdbm-dev liblzma-dev \
  libncursesw5-dev libsqlite3-dev libssl-dev \
  zlib1g-dev uuid-dev tk-dev
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;更に必要なものがある場合、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make&lt;/code&gt; 後に出力されるメッセージで確認可能。（再度 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make&lt;/code&gt; する必要があるが）&lt;br /&gt;
（開発に不要なものなら無視してもよいだろう）&lt;/p&gt;

&lt;h3 id=&quot;3-アーカイブのダウンロード展開&quot;&gt;3. アーカイブのダウンロード＆展開&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://www.python.org/downloads/release/python-397/&quot; title=&quot;Python Release Python 3.9.7 - Python.org&quot;&gt;こちら&lt;/a&gt; から 3.9 系の最新安定版（当記事執筆時点では 3.9.7）のアーカイブ（今回は tgz 版）をダウンロード・展開する。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cd /usr/local/src
# wget https://www.python.org/ftp/python/3.9.7/Python-3.9.7.tgz
# tar xvf Python-3.9.7.tgz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;4-ビルドインストール&quot;&gt;4. ビルド＆インストール&lt;/h3&gt;

&lt;p&gt;3.9 系以外のバージョンの Python と共存させるら、 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--prefix&lt;/code&gt; でインストール先を指定する。
また、あらゆるサイト等で紹介されている &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--enable-shared&lt;/code&gt; のオプションは、メリットがない（むしろ問題点がある）ので使用しない。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cd  Python-3.9.7
# ./configure
# make -j$(grep &apos;^processor&apos; /proc/cpuinfo | wc -l)
# make install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;もし、ビルドソースに問題がないか等をテストしたければ、 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make&lt;/code&gt; のあとで &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make test&lt;/code&gt; でチェックしてみるとよい。&lt;/p&gt;

&lt;h3 id=&quot;5-pip-の更新&quot;&gt;5. pip の更新&lt;/h3&gt;

&lt;p&gt;pip を最新版に更新しておく。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# pip3.9 -V
pip 21.2.3 from /usr/local/lib/python3.9/site-packages/pip (python 3.9)

# pip3.9 install --upgrade pip

# pip3.9 -V
pip 21.2.4 from /usr/local/lib/python3.9/site-packages/pip (python 3.9)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;6-インストールの確認&quot;&gt;6. インストールの確認&lt;/h3&gt;

&lt;p&gt;（ログインし直してから）&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# python3.9 -V
Python 3.9.7

# python3 -V
Python 3.9.7

# pip3 -V
pip 21.2.4 from /usr/local/lib/python3.9/site-packages/pip (python 3.9)

# pip3.9 -V
pip 21.2.4 from /usr/local/lib/python3.9/site-packages/pip (python 3.9)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;7-動作確認&quot;&gt;7. 動作確認&lt;/h3&gt;

&lt;p&gt;対話形式で確認してみる。（ユークリッドの互除法で再帰的に最大公約数を求めてみる）&lt;br /&gt;
（対話形式を終了するには &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CTRL-D&lt;/code&gt;）&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# python3
Python 3.9.7 (default, Sep 19 2021, 10:19:01)
[GCC 10.2.1 20210110] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&amp;gt;&amp;gt;&amp;gt; def gcd(a, b):
...     if b == 0:
...             return a
...     else:
...             return gcd(b, a % b)
...
&amp;gt;&amp;gt;&amp;gt; print(&quot;TheGCD for (123, 45): {}&quot;.format(gcd(123, 45)))
TheGCD for (123, 45): 3
&amp;gt;&amp;gt;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;上記と同じことをファイルを作成して実行してみる。&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gcd.py&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;gcd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gcd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TheGCD for (123, 45): {}&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gcd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# python3 gcd.py
The GCD for (123, 45): 3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;8-参考サイト&quot;&gt;8. 参考サイト&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.python.jp/&quot; title=&quot;プログラミング言語 Python&quot;&gt;プログラミング言語 Python&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;以上&lt;/p&gt;</content><author><name>mk-mode.com</name></author><category term="サーバ構築" /><category term="Debian" /><category term="Linux" /><category term="Python" /><summary type="html">Debian GNU/Linux 11 (bullseye) に Python 3.9 をソースをビルドしてインストールする方法についての記録です。 以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。 （当然ながら、興味がなければスルーしてください）</summary></entry><entry><title type="html">2022年2月 - OS・ブラウザ別アクセス状況！</title><link href="https://komasaru.github.io/2022/03/01/blog-access/" rel="alternate" type="text/html" title="2022年2月 - OS・ブラウザ別アクセス状況！" /><published>2022-03-01T00:20:00+09:00</published><updated>2022-03-01T00:20:00+09:00</updated><id>https://komasaru.github.io/2022/03/01/blog-access</id><content type="html" xml:base="https://komasaru.github.io/2022/03/01/blog-access/">&lt;p&gt;3月になりましたので、先月2月分の当ブログアクセス状況を公開します。（※自分用の記録）&lt;/p&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;1-アクセスをos別に集計&quot;&gt;1. アクセスをOS別に集計&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;OS&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;PageViews&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;比率(%)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;20,005&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;67.4796&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mac OS&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;6,967&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;23.5006&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1,221&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;4.1186&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Android&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;974&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3.2854&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ubuntu Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;294&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.9917&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;147&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.4959&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Fedora Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;28&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0944&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FreeBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;6&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0202&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;PlayStation&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0101&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;OpenBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0034&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;tfoot&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;合　計&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;29,646&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;100.0000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tfoot&gt;
&lt;/table&gt;

&lt;h3 id=&quot;2-アクセスをosバージョン別に集計&quot;&gt;2. アクセスをOS・バージョン別に集計&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;OS&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Version&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;PageViews&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;比率(%)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;10&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;16,011&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;54.0073&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mac OS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;X&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;6,967&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;23.5006&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;7&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3,688&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;12.4401&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1,221&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;4.1186&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Android&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;974&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3.2854&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Ubuntu Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;294&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.9917&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;8.1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;263&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.8871&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;147&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.4959&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Fedora Linux&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;28&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0944&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;8&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;23&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0776&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;XP&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;11&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0371&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;FreeBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;6&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0202&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Vista&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;5&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0169&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;PlayStation&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0101&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0101&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;OpenBSD&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0034&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Windows&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Server 2003&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0034&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;tfoot&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;合　計&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;29,646&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;100.0000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tfoot&gt;
&lt;/table&gt;

&lt;h3 id=&quot;3-アクセスをブラウザ別に集計&quot;&gt;3. アクセスをブラウザ別に集計&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;ブラウザ&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;PageViews&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;比率(%)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;18,628&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;62.8348&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Safari&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;4,140&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;13.9648&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Netscape Navigator&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3,591&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;12.1129&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mozilla Firefox&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2,936&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;9.9035&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Internet Explorer&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;344&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.1604&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mozilla&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0067&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Opera&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0067&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mozilla SeaMonkey&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0067&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;unknown&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.0034&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;tfoot&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;合　計&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;29,646&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;100.0000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tfoot&gt;
&lt;/table&gt;

&lt;h3 id=&quot;4-アクセスをブラウザバージョン別に集計上位20件&quot;&gt;4. アクセスをブラウザ・バージョン別に集計（上位20件）&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;ブラウザ&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Version&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;PageViews&lt;/th&gt;
      &lt;th style=&quot;text-align: right&quot;&gt;比率(%)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0.4758.102&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;5,393&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;18.1913&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;97.0.4692.99&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;4,763&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;16.0662&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Netscape Navigator&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;5.0&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3,591&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;12.1129&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0.4758.82&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2,624&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;8.8511&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0.4758.80&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2,473&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;8.3418&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Safari&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9537.53&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1,774&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;5.9839&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Safari&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;604.1&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1,529&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;5.1575&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mozilla Firefox&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;97.0&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1,293&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;4.3615&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mozilla Firefox&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;96.0&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;896&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;3.0223&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Safari&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;605.1.15&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;824&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;2.7795&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0.4758.87&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;486&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.6393&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;97.0.4692.71&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;469&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.5820&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Mozilla Firefox&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;91.0&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;376&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.2683&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0.4758.81&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;347&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.1705&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Internet Explorer&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;11.0&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;336&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;1.1334&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0.4758.101&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;265&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.8939&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;96.0.4664.110&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;216&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.7286&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;97.0.4692.98&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;142&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.4790&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;98.0.4758.109&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;141&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.4756&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Chrome&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;96.0.4664.93&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;134&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;0.4520&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;：&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;：&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;：&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;：&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;tfoot&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;合　計&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;29,646&lt;/td&gt;
      &lt;td style=&quot;text-align: right&quot;&gt;100.0000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tfoot&gt;
&lt;/table&gt;

&lt;hr /&gt;

&lt;p&gt;以上。&lt;/p&gt;</content><author><name>mk-mode.com</name></author><category term="ブログ" /><category term="Jekyll" /><summary type="html">3月になりましたので、先月2月分の当ブログアクセス状況を公開します。（※自分用の記録）</summary></entry><entry><title type="html">Debian 11 (bullseye) - Ruby 3.0 インストール（ソースビルド）！</title><link href="https://komasaru.github.io/2022/02/23/debian-11-ruby-3-0-installation-by-src/" rel="alternate" type="text/html" title="Debian 11 (bullseye) - Ruby 3.0 インストール（ソースビルド）！" /><published>2022-02-23T00:20:00+09:00</published><updated>2022-02-23T00:20:00+09:00</updated><id>https://komasaru.github.io/2022/02/23/debian-11-ruby-3-0-installation-by-src</id><content type="html" xml:base="https://komasaru.github.io/2022/02/23/debian-11-ruby-3-0-installation-by-src/">&lt;p&gt;Debian GNU/Linux 11 (bullseye) に Ruby 3.0 をソースをビルドしてインストール方法についての記録です。&lt;/p&gt;

&lt;p&gt;以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。&lt;br /&gt;
（当然ながら、興味がなければスルーしてください）&lt;/p&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;0-前提条件&quot;&gt;0. 前提条件&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Debian GNU/Linux 11.1.0 (bullseye; 64bit) での作業を想定。&lt;/li&gt;
  &lt;li&gt;接続元のマシンも Debian GNU/Linux 11 (bullseye; 64bit) を想定。&lt;/li&gt;
  &lt;li&gt;インストールするは当記事執筆時点で最新の Ruby は 3.0.2.&lt;/li&gt;
  &lt;li&gt;root ユーザでの作業を想定。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;1-必要パッケージのインストール&quot;&gt;1. 必要パッケージのインストール&lt;/h3&gt;

&lt;p&gt;Ruby のインストールに必要なパッケージを予めインストールする。（他に必要なものがあればインストールする）&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# apt -y install libffi-dev zlib1g-dev libssl-dev libreadline-dev \
libgdbm-dev libbison-dev libmariadb-dev
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2-アーカイブファイルのダウンロード展開&quot;&gt;2. アーカイブファイルのダウンロード＆展開&lt;/h3&gt;

&lt;p&gt;アーカイブファイルをダンロードし、展開する。（ダンロード先は &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/usr/local/src&lt;/code&gt; としている）&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cd /usr/local/src
# wget https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.2.tar.gz
# tar xvf ruby-3.0.2.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;3-ビルドインストール&quot;&gt;3. ビルド＆インストール&lt;/h3&gt;

&lt;p&gt;ビルドインストールは以下のように行う。（よくある &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.configure&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make install&lt;/code&gt;）&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cd ruby-3.0.2
# ./configure
# make -j$(grep &apos;^processor&apos; /proc/cpuinfo | wc -l)
# make install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;4-インストールの確認&quot;&gt;4. インストールの確認&lt;/h3&gt;

&lt;p&gt;バージョンを表示させてみて、インストールできているか確認する。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ruby -v
ruby 3.0.2p107 (2021-07-07 revision 0db68f0233) [x86_64-linux]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;5-ドキュメントの非インストール設定&quot;&gt;5. ドキュメントの非インストール設定&lt;/h3&gt;

&lt;p&gt;サーバ環境には RubyGems ライブラリのドキュメントは不要なので、 RubyGems ライブラリインストール時にドキュメントをインストールしないように設定する。&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/.gemrc&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;: &lt;span class=&quot;nt&quot;&gt;--no-document&lt;/span&gt;
update: &lt;span class=&quot;nt&quot;&gt;--no-document&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;6-gem-の最新化&quot;&gt;6. gem の最新化&lt;/h3&gt;

&lt;p&gt;今後のために、gem を最新に更新しておく。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# gem -v
3.2.22

# gem update --system

# gem -v
3.2.27
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;7-動作確認&quot;&gt;7. 動作確認&lt;/h3&gt;

&lt;p&gt;適当にコーディングして、正常に動作するか確認する。&lt;br /&gt;
Ruby スクリプトファイルを作成して実行してもよいし、&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;irb&lt;/code&gt; や &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pry&lt;/code&gt; でコーディングしてもよい。以下はコマンドラインから実行した例。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ruby -e &apos;5.times {puts &quot;Hello Ruby!&quot;}&apos;
Hello Ruby!
Hello Ruby!
Hello Ruby!
Hello Ruby!
Hello Ruby!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;p&gt;以上。&lt;/p&gt;</content><author><name>mk-mode.com</name></author><category term="サーバ構築" /><category term="Debian" /><category term="Linux" /><category term="Ruby" /><summary type="html">Debian GNU/Linux 11 (bullseye) に Ruby 3.0 をソースをビルドしてインストール方法についての記録です。 以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。 （当然ながら、興味がなければスルーしてください）</summary></entry><entry><title type="html">Debian 11 (bullseye) - Let’s Encrypt で常時 SSL 化(on Nginx)！</title><link href="https://komasaru.github.io/2022/02/16/debian-11-nginx-ssl-by-lets-encrypt/" rel="alternate" type="text/html" title="Debian 11 (bullseye) - Let’s Encrypt で常時 SSL 化(on Nginx)！" /><published>2022-02-16T00:20:00+09:00</published><updated>2022-02-16T00:20:00+09:00</updated><id>https://komasaru.github.io/2022/02/16/debian-11-nginx-ssl-by-lets-encrypt</id><content type="html" xml:base="https://komasaru.github.io/2022/02/16/debian-11-nginx-ssl-by-lets-encrypt/">&lt;p&gt;Debian GNU/Linux 11 (bullseye) に構築した Web サーバ Nginx への接続を、 Let’s Encrypt で取得した SSL サーバ証明書で常時 SSL 化するための方法についての記録です。&lt;/p&gt;

&lt;p&gt;（当然ながら、興味がなければスルーしてください）&lt;/p&gt;

&lt;!--more--&gt;

&lt;h3 id=&quot;0-前提条件&quot;&gt;0. 前提条件&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Debian GNU/Linux 11 (bullseye; 64bit) での作業を想定。&lt;/li&gt;
  &lt;li&gt;クライアント側も Debian GNU/Linux 11 (bullseye; 64bit) を想定。&lt;/li&gt;
  &lt;li&gt;Web(HTTP)サーバ Nginx が「&lt;a href=&quot;/2022/02/02/debian-11-nginx-installation-by-official-apt&quot; title=&quot;Debian 11 (bullseye) - Web サーバ Nginx 構築（Nginx 公式リポジトリ使用）！&quot;&gt;Debian 11 (bullseye) - Web サーバ Nginx 構築（Nginx 公式リポジトリ使用）！&lt;/a&gt;」の方法で導入済みであることを想定。&lt;/li&gt;
  &lt;li&gt;Nginx 1.21.3 での作業を想定。（稼働していること。稼働していない場合は方法が若干異なる）&lt;/li&gt;
  &lt;li&gt;ACME(Automatic Certificate Management Environment) クライアントに Certbot を使用することを想定。&lt;/li&gt;
  &lt;li&gt;バーチャルホストは使用しない。&lt;/li&gt;
  &lt;li&gt;root ユーザでの作業を想定。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;1-acme-クライアント-certbot-のインストール&quot;&gt;1. ACME クライアント Certbot のインストール&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# apt -y install certbot

# certbot --version
certbot 1.12.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;当記事執筆時点、 1.12.0 がインストールされた。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;2-ポートの開放&quot;&gt;2. ポートの開放&lt;/h3&gt;

&lt;p&gt;ドメイン所有者の認証のために TCP ポートの 80 番と 443 番に接続されるので、開放されてなければ開放しておく。&lt;/p&gt;

&lt;p&gt;ufw コマンドによるポート開放については、過去記事「&lt;a href=&quot;/2021/10/20/debian-11-firewall-setting&quot; title=&quot;Debian 11 (bullseye) - ファイアウォール設定！&quot;&gt;Debian 11 (bullseye) - ファイアウォール設定！&lt;/a&gt;」を参照。&lt;/p&gt;

&lt;h3 id=&quot;3-certbot-クライアントの起動&quot;&gt;3. Certbot クライアントの起動&lt;/h3&gt;

&lt;p&gt;証明書発行のために Certbot クライアントを起動する。ドキュメントルートにするディレクトリが存在しなければ、作成しておく。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir -p /var/www/html
# certbot certonly --webroot -w /var/www/html -d example.jp -d www.example.jp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;example.jp&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;www.example.jp&lt;/code&gt; は自分のものに置き換えること。&lt;/li&gt;
  &lt;li&gt;起動後の設定は次項。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;4-メールアドレス等の設定&quot;&gt;4. メールアドレス等の設定&lt;/h3&gt;

&lt;p&gt;メールアドレスの登録と利用条件への同意を行う。（初回のみ）&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Saving debug log to /var/log/letsencrypt/letsencrypt.log
Plugins selected: Authenticator webroot, Installer None
Enter email address (used for urgent renewal and security notices)
 (Enter &apos;c&apos; to cancel): webmaster@example.jp

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Please read the Terms of Service at
https://letsencrypt.org/documents/LE-SA-v1.2-November-15-2017.pdf. You must
agree in order to register with the ACME server. Do you agree?
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(Y)es/(N)o: Y

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Would you be willing, once your first certificate is successfully issued, to
share your email address with the Electronic Frontier Foundation, a founding
partner of the Let&apos;s Encrypt project and the non-profit organization that
develops Certbot? We&apos;d like to send you email about our work encrypting the web,
EFF news, campaigns, and ways to support digital freedom.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
(Y)es/(N)o: Y
Account registered.
Requesting a certificate for example.jp and www.example.jp
Performing the following challenges:
http-01 challenge for example.jp
http-01 challenge for www.example.jp
Using the webroot path /var/www/html for all unmatched domains.
Waiting for verification...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;ルータでポート開放してからでないと失敗する。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;5-ssltls-サーバ証明書の取得完了&quot;&gt;5. SSL/TLS サーバ証明書の取得完了&lt;/h3&gt;

&lt;p&gt;しばらく待つと、SSL/TLS サーバ証明書の取得プロセスが完了する。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;サーバ証明書の実体（ファイル）は、 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/letsencrypt/archive/ドメイン名&lt;/code&gt; ディレクトリ配下に保存される。
    &lt;ul&gt;
      &lt;li&gt;サーバ証明書（公開鍵） … &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;certN.pem&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;中間証明書 … &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chainN.pem&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;サーバ証明書と中間証明書の結合ファイル … &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fullchainN.pem&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;秘密鍵 … &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;privkeyN.pem&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;シンボリックリンクは、 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/letsencrypt/live/ドメイン名&lt;/code&gt; ディレクトリ配下に保存される。
    &lt;ul&gt;
      &lt;li&gt;サーバ証明書（公開鍵） … &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cert.pem&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;中間証明書 … &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chain.pem&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;サーバ証明書と中間証明書の結合ファイル … &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fullchain.pem&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;秘密鍵 … &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;privkey.pem&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;SSL/TLS サーバ証明書の取得に失敗した場合は、ポート開放等の設定を再確認する。&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;6-nginx-設定ファイルの編集&quot;&gt;6. Nginx 設定ファイルの編集&lt;/h3&gt;

&lt;p&gt;環境により設定ファイルの配置ディレクトリやファイル名、記述方法等が異なるかもしれない。適宜置き換えること。&lt;/p&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/nginx/conf.d/default.conf&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;server &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    listen 80&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#       :&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# ===&amp;lt; 中略 &amp;gt;===&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#       :&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;301 https://&lt;span class=&quot;nv&quot;&gt;$host$request_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# &amp;lt;= 追加&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#       :&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# ===&amp;lt; 中略 &amp;gt;===&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#       :&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;File: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/nginx/conf.d/ssl.conf&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;server &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    listen 443 ssl&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#       :&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# ===&amp;lt; 中略 &amp;gt;===&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#       :&lt;/span&gt;
    ssl on&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                                                               &lt;span class=&quot;c&quot;&gt;# &amp;lt;= 追加&lt;/span&gt;
    ssl_protocols       TLSv1 TLSv1.1 TLSv1.2&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                            &lt;span class=&quot;c&quot;&gt;# &amp;lt;= 追加&lt;/span&gt;
    ssl_certificate     /etc/letsencrypt/live/example.com/fullchain.pem&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  &lt;span class=&quot;c&quot;&gt;# &amp;lt;= 追加&lt;/span&gt;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    &lt;span class=&quot;c&quot;&gt;# &amp;lt;= 追加&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#       :&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;# ===&amp;lt; 中略 &amp;gt;===&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;#       :&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;7-nginx-設定ファイルの文法チェック&quot;&gt;7. Nginx 設定ファイルの文法チェック&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;問題があれば、設定ファイルの内容を見直す。&lt;/p&gt;

&lt;h3 id=&quot;8-web-サーバ-の再起動&quot;&gt;8. Web サーバ の再起動&lt;/h3&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl restart nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;9-証明書の更新&quot;&gt;9. 証明書の更新&lt;/h3&gt;

&lt;p&gt;Certbot にはタイマーが搭載されているので、自動で定期的に証明書が更新される。&lt;/p&gt;

&lt;p&gt;Certbot タイマーの詳細を確認するなら、以下を実行。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl status certbot.timer

# systemctl list-timers certbot.timer --no-pager

# systemctl cat certbot.timer

# systemctl cat certbot.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;タイマーによる更新でなく、手動で更新したい場合は以下を実行。&lt;/p&gt;

&lt;div class=&quot;language-text highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# certbot renew
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;10-参考サイト&quot;&gt;10. 参考サイト&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://certbot.eff.org/docs/using.html#certbot-command-line-options&quot; title=&quot;Certbot command-line options&quot;&gt;Certbot command-line options&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;以上。&lt;/p&gt;</content><author><name>mk-mode.com</name></author><category term="サーバ構築" /><category term="Debian" /><category term="Linux" /><category term="Nginx" /><category term="SSL" /><summary type="html">Debian GNU/Linux 11 (bullseye) に構築した Web サーバ Nginx への接続を、 Let’s Encrypt で取得した SSL サーバ証明書で常時 SSL 化するための方法についての記録です。 （当然ながら、興味がなければスルーしてください）</summary></entry></feed>