<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ja" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>CentOS 6.5 - ファイアウォール（iptables）構築！ - mk-mode BLOG</title>
<meta name="description" content="前回は CentOS 6.5 サーバにアンチウィルスソフト Clam AntiVirus の導入を行いました。今回はファイアウォール iptables の構築を行います。">



<meta property="og:type" content="article">
<meta property="og:locale" content="ja_JP">
<meta property="og:site_name" content="mk-mode BLOG">
<meta property="og:title" content="CentOS 6.5 - ファイアウォール（iptables）構築！">
<meta property="og:url" content="https://komasaru.github.io/2013/12/20/centos-6-5-iptables-installation/">


  <meta property="og:description" content="前回は CentOS 6.5 サーバにアンチウィルスソフト Clam AntiVirus の導入を行いました。今回はファイアウォール iptables の構築を行います。">



  <meta property="og:image" content="https://www.mk-mode.com/blog/assets/images/about_me.png">



  <meta name="twitter:site" content="@rsm_mzk">
  <meta name="twitter:title" content="CentOS 6.5 - ファイアウォール（iptables）構築！">
  <meta name="twitter:description" content="前回は CentOS 6.5 サーバにアンチウィルスソフト Clam AntiVirus の導入を行いました。今回はファイアウォール iptables の構築を行います。">
  <meta name="twitter:url" content="https://komasaru.github.io/2013/12/20/centos-6-5-iptables-installation/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://www.mk-mode.com/blog/assets/images/about_me.png">
    
  

  



  <meta property="article:published_time" content="2013-12-20T00:20:00+09:00">





  

  


<link rel="canonical" href="https://komasaru.github.io/2013/12/20/centos-6-5-iptables-installation/">





  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "url": "https://komasaru.github.io",
      "logo": "https://www.mk-mode.com/blog/assets/images/about_me.png"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "mk-mode.com",
      "url": "https://komasaru.github.io",
      "sameAs": null
    }
  </script>



  <meta name="google-site-verification" content="0kSwKhNo71fC7OeEFLllD3S11F8Pa-z_OqsBTSFxXAk" />





<!-- end _includes/seo.html -->


<link href="https://www.mk-mode.com/blog/atom.xml" type="application/atom+xml" rel="alternate" title="mk-mode BLOG Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


  
    
    <script defer src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    <!-- start custom head snippets -->

<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="//pagead2.googlesyndication.com" />
<link rel="dns-prefetch" href="//googleads.g.doubleclick.net" />
<link rel="dns-prefetch" href="//tpc.googlesyndication.com" />
<link rel="dns-prefetch" href="//cm.g.doubleclick.net" />
<link rel="dns-prefetch" href="//www.gstatic.com" />
<link rel="dns-prefetch" href="//fonts.gstatic.com" />
<link rel='dns-prefetch' href='//use.fontawesome.com' />
<link rel="dns-prefetch" href="//twitter.com" />
<link rel="dns-prefetch" href="//www.facebook.com" />

<link rel="icon" href="/assets/images/favicon.ico">
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18154748-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-7320193476057758",
      enable_page_level_ads: true
    });
  </script>


<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">mk-mode BLOG</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/year-archive/" >Archives</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.mk-mode.com/rails/calendar/calendar" >Calendar</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.mk-mode.com/rails/jmaxml" >JMAXML</a>
            </li><li class="masthead__menu-item">
              <a href="/privacy.html" >Privacy Policy</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/about_me.png" alt="mk-mode.com" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">mk-mode.com</h3>
    
    
      <p class="author__bio" itemprop="description">
        Linux, Debian, IT, Server, PG, Ruby, Rails, Python, C++, Fortran, PC, MariaDB, math, GIS, etc...
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Ruby City MATSUE</span>
        </li>
      

      
        
          
        
          
            <li><a href="https://www.mk-mode.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode SITE</a></li>
          
        
          
            <li><a href="https://www.mk-mode.com/blog" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode BLOG (original)</a></li>
          
        
          
            <li><a href="https://mk-mode.tumblr.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode TUMBLR</a></li>
          
        
          
            <li><a href="https://mk-ephemeris.tumblr.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode EPHEMERIS</a></li>
          
        
          
            <li><a href="https://twitter.com/rsm_mzk" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
          
        
          
        
          
            <li><a href="https://github.com/komasaru" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="CentOS 6.5 - ファイアウォール（iptables）構築！">
    <meta itemprop="description" content="前回は CentOS 6.5 サーバにアンチウィルスソフト Clam AntiVirus の導入を行いました。今回はファイアウォール iptables の構築を行います。">
    <meta itemprop="datePublished" content="December 20, 2013">
    

    <div class="page__inner-wrap">
      
        <header>
          <!-- div id="google-ad-1"></div -->
          <h1 id="page-title" class="page__title" itemprop="headline">CentOS 6.5 - ファイアウォール（iptables）構築！
</h1>
          
          
            
            <p class="page__date"><small><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2013-12-20T00:20:00+09:00">2013-12-20 00:20</time></small></p>
          
        </header>
      
      <div id="google-ad-2"></div>
      <br />

      <section class="page__content" itemprop="text">
        
        <p>前回は CentOS 6.5 サーバにアンチウィルスソフト Clam AntiVirus の導入を行いました。<br />
今回はファイアウォール iptables の構築を行います。</p>

<!--more-->

<h3 id="0-前提条件">0. 前提条件</h3>

<ul>
  <li>CentOS 6.5(x86_64) を Minimal で最小インストールしている。</li>
  <li>クライントマシンは Linux Mint 14(64bit) を想定。</li>
  <li>SSH のポートはセキュリティ上デフォルトの 22 から変更している。</li>
  <li>「<a href="http://centossrv.com/" title="CentOSで自宅サーバー構築">CentOSで自宅サーバー構築</a>」を参考にしている。<br />
（実際は、過去にこのサイトを参考にして作業した際に記録していたものを参照している）<br />
（また、最初のうちはそのままコピーさせてもらっているが、今後各種サーバを構築していくにつれポート開放部分を追加していく）</li>
</ul>

<h3 id="1-ファイアウォール設定スクリプト作成">1. ファイアウォール設定スクリプト作成</h3>

<p>以下のようにファイアウォール設定スクリプトを作成する。</p>

<p>File: <code class="language-plaintext highlighter-rouge">iptables.sh</code></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>

<span class="c">#---------------------------------------#</span>
<span class="c"># 設定開始                              #</span>
<span class="c">#---------------------------------------#</span>

<span class="c"># インタフェース名定義</span>
<span class="nv">LAN</span><span class="o">=</span>eth0

<span class="c">#---------------------------------------#</span>
<span class="c"># 設定終了                              #</span>
<span class="c">#---------------------------------------#</span>

<span class="c"># 内部ネットワークのネットマスク取得</span>
<span class="nv">LOCALNET_MASK</span><span class="o">=</span><span class="sb">`</span>ifconfig <span class="nv">$LAN</span>|sed <span class="nt">-e</span> <span class="s1">'s/^.*Mask:\([^ ]*\)$/\1/p'</span> <span class="nt">-e</span> d<span class="sb">`</span>

<span class="c"># 内部ネットワークアドレス取得</span>
<span class="nv">LOCALNET_ADDR</span><span class="o">=</span><span class="sb">`</span>netstat <span class="nt">-rn</span>|grep <span class="nv">$LAN</span>|grep <span class="nv">$LOCALNET_MASK</span>|cut <span class="nt">-f1</span> <span class="nt">-d</span><span class="s1">' '</span><span class="sb">`</span>
<span class="nv">LOCALNET</span><span class="o">=</span><span class="nv">$LOCALNET_ADDR</span>/<span class="nv">$LOCALNET_MASK</span>

<span class="c"># ファイアウォール停止(すべてのルールをクリア)</span>
/etc/rc.d/init.d/iptables stop

<span class="c"># デフォルトルール(以降のルールにマッチしなかった場合に適用するルール)設定</span>
iptables <span class="nt">-P</span> INPUT   DROP   <span class="c"># 受信はすべて破棄</span>
iptables <span class="nt">-P</span> OUTPUT  ACCEPT <span class="c"># 送信はすべて許可</span>
iptables <span class="nt">-P</span> FORWARD DROP   <span class="c"># 通過はすべて破棄</span>

<span class="c"># 自ホストからのアクセスをすべて許可</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-i</span> lo <span class="nt">-j</span> ACCEPT

<span class="c"># 内部からのアクセスをすべて許可</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-s</span> <span class="nv">$LOCALNET</span> <span class="nt">-j</span> ACCEPT

<span class="c"># 内部から行ったアクセスに対する外部からの返答アクセスを許可</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-m</span> state <span class="nt">--state</span> ESTABLISHED,RELATED <span class="nt">-j</span> ACCEPT

<span class="c"># SYN Cookiesを有効にする</span>
<span class="c"># ※TCP SYN Flood攻撃対策</span>
sysctl <span class="nt">-w</span> net.ipv4.tcp_syncookies<span class="o">=</span>1 <span class="o">&gt;</span> /dev/null
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/net.ipv4.tcp_syncookies/d'</span> /etc/sysctl.conf
<span class="nb">echo</span> <span class="s2">"net.ipv4.tcp_syncookies=1"</span> <span class="o">&gt;&gt;</span> /etc/sysctl.conf

<span class="c"># ブロードキャストアドレス宛pingには応答しない</span>
<span class="c"># ※Smurf攻撃対策</span>
sysctl <span class="nt">-w</span> net.ipv4.icmp_echo_ignore_broadcasts<span class="o">=</span>1 <span class="o">&gt;</span> /dev/null
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/net.ipv4.icmp_echo_ignore_broadcasts/d'</span> /etc/sysctl.conf
<span class="nb">echo</span> <span class="s2">"net.ipv4.icmp_echo_ignore_broadcasts=1"</span> <span class="o">&gt;&gt;</span> /etc/sysctl.conf

<span class="c"># ICMP Redirectパケットは拒否</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/net.ipv4.conf.*.accept_redirects/d'</span> /etc/sysctl.conf
<span class="k">for </span>dev <span class="k">in</span> <span class="sb">`</span><span class="nb">ls</span> /proc/sys/net/ipv4/conf/<span class="sb">`</span>
<span class="k">do
    </span>sysctl <span class="nt">-w</span> net.ipv4.conf.<span class="nv">$dev</span>.accept_redirects<span class="o">=</span>0 <span class="o">&gt;</span> /dev/null
    <span class="nb">echo</span> <span class="s2">"net.ipv4.conf.</span><span class="nv">$dev</span><span class="s2">.accept_redirects=0"</span> <span class="o">&gt;&gt;</span> /etc/sysctl.conf
<span class="k">done</span>

<span class="c"># Source Routedパケットは拒否</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/net.ipv4.conf.*.accept_source_route/d'</span> /etc/sysctl.conf
<span class="k">for </span>dev <span class="k">in</span> <span class="sb">`</span><span class="nb">ls</span> /proc/sys/net/ipv4/conf/<span class="sb">`</span>
<span class="k">do
    </span>sysctl <span class="nt">-w</span> net.ipv4.conf.<span class="nv">$dev</span>.accept_source_route<span class="o">=</span>0 <span class="o">&gt;</span> /dev/null
    <span class="nb">echo</span> <span class="s2">"net.ipv4.conf.</span><span class="nv">$dev</span><span class="s2">.accept_source_route=0"</span> <span class="o">&gt;&gt;</span> /etc/sysctl.conf
<span class="k">done</span>

<span class="c"># フラグメント化されたパケットはログを記録して破棄</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-f</span> <span class="nt">-j</span> LOG <span class="nt">--log-prefix</span> <span class="s1">'[IPTABLES FRAGMENT] : '</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-f</span> <span class="nt">-j</span> DROP

<span class="c"># 外部とのNetBIOS関連のアクセスはログを記録せずに破棄</span>
<span class="c"># ※不要ログ記録防止</span>
iptables <span class="nt">-A</span> INPUT <span class="o">!</span> <span class="nt">-s</span> <span class="nv">$LOCALNET</span> <span class="nt">-p</span> tcp <span class="nt">-m</span> multiport <span class="nt">--dports</span> 135,137,138,139,445 <span class="nt">-j</span> DROP
iptables <span class="nt">-A</span> INPUT <span class="o">!</span> <span class="nt">-s</span> <span class="nv">$LOCALNET</span> <span class="nt">-p</span> udp <span class="nt">-m</span> multiport <span class="nt">--dports</span> 135,137,138,139,445 <span class="nt">-j</span> DROP
iptables <span class="nt">-A</span> OUTPUT <span class="o">!</span> <span class="nt">-d</span> <span class="nv">$LOCALNET</span> <span class="nt">-p</span> tcp <span class="nt">-m</span> multiport <span class="nt">--sports</span> 135,137,138,139,445 <span class="nt">-j</span> DROP
iptables <span class="nt">-A</span> OUTPUT <span class="o">!</span> <span class="nt">-d</span> <span class="nv">$LOCALNET</span> <span class="nt">-p</span> udp <span class="nt">-m</span> multiport <span class="nt">--sports</span> 135,137,138,139,445 <span class="nt">-j</span> DROP

<span class="c"># 1秒間に4回を超えるpingはログを記録して破棄</span>
<span class="c"># ※Ping of Death攻撃対策</span>
iptables <span class="nt">-N</span> LOG_PINGDEATH
iptables <span class="nt">-A</span> LOG_PINGDEATH <span class="nt">-m</span> limit <span class="nt">--limit</span> 1/s <span class="nt">--limit-burst</span> 4 <span class="nt">-j</span> ACCEPT
iptables <span class="nt">-A</span> LOG_PINGDEATH <span class="nt">-j</span> LOG <span class="nt">--log-prefix</span> <span class="s1">'[IPTABLES PINGDEATH] : '</span>
iptables <span class="nt">-A</span> LOG_PINGDEATH <span class="nt">-j</span> DROP
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> icmp <span class="nt">--icmp-type</span> echo-request <span class="nt">-j</span> LOG_PINGDEATH

<span class="c"># 全ホスト(ブロードキャストアドレス、マルチキャストアドレス)宛パケットはログを記録せずに破棄</span>
<span class="c"># ※不要ログ記録防止</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-d</span> 255.255.255.255 <span class="nt">-j</span> DROP
iptables <span class="nt">-A</span> INPUT <span class="nt">-d</span> 224.0.0.1 <span class="nt">-j</span> DROP

<span class="c"># 113番ポート(IDENT)へのアクセスには拒否応答</span>
<span class="c"># ※メールサーバ等のレスポンス低下防止</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 113 <span class="nt">-j</span> REJECT <span class="nt">--reject-with</span> tcp-reset

<span class="c"># ACCEPT_COUNTRY_MAKE関数定義</span>
<span class="c"># 指定された国のIPアドレスからのアクセスを許可するユーザ定義チェイン作成</span>
ACCEPT_COUNTRY_MAKE<span class="o">(){</span>
    <span class="k">for </span>addr <span class="k">in</span> <span class="sb">`</span><span class="nb">cat</span> /tmp/cidr.txt|grep ^<span class="nv">$1</span>|awk <span class="s1">'{print $2}'</span><span class="sb">`</span>
    <span class="k">do
        </span>iptables <span class="nt">-A</span> ACCEPT_COUNTRY <span class="nt">-s</span> <span class="nv">$addr</span> <span class="nt">-j</span> ACCEPT
    <span class="k">done</span>
<span class="o">}</span>

<span class="c"># DROP_COUNTRY_MAKE関数定義</span>
<span class="c"># 指定された国のIPアドレスからのアクセスを破棄するユーザ定義チェイン作成</span>
DROP_COUNTRY_MAKE<span class="o">(){</span>
    <span class="k">for </span>addr <span class="k">in</span> <span class="sb">`</span><span class="nb">cat</span> /tmp/cidr.txt|grep ^<span class="nv">$1</span>|awk <span class="s1">'{print $2}'</span><span class="sb">`</span>
    <span class="k">do
        </span>iptables <span class="nt">-A</span> DROP_COUNTRY <span class="nt">-s</span> <span class="nv">$addr</span> <span class="nt">-m</span> limit <span class="nt">--limit</span> 1/s <span class="nt">-j</span> LOG <span class="nt">--log-prefix</span> <span class="s1">'[IPTABLES DENY_COUNTRY] : '</span>
        iptables <span class="nt">-A</span> DROP_COUNTRY <span class="nt">-s</span> <span class="nv">$addr</span> <span class="nt">-j</span> DROP
    <span class="k">done</span>
<span class="o">}</span>

<span class="c"># IPアドレスリスト取得</span>
<span class="nb">.</span> /root/iptables_functions
IPLISTGET

<span class="c"># 日本からのアクセスを許可するユーザ定義チェインACCEPT_COUNTRY作成</span>
iptables <span class="nt">-N</span> ACCEPT_COUNTRY
ACCEPT_COUNTRY_MAKE JP
<span class="c"># 以降,日本からのみアクセスを許可したい場合はACCEPTのかわりにACCEPT_COUNTRYを指定する</span>

<span class="c"># 中国・イラン・韓国※からのアクセスをログを記録して破棄</span>
<span class="c"># ※全国警察施設への攻撃元上位３カ国(日本・アメリカを除く)</span>
<span class="c"># http://www.cyberpolice.go.jp/detect/observation.htmlより</span>
iptables <span class="nt">-N</span> DROP_COUNTRY
DROP_COUNTRY_MAKE CN
DROP_COUNTRY_MAKE IR
DROP_COUNTRY_MAKE KR
iptables <span class="nt">-A</span> INPUT <span class="nt">-j</span> DROP_COUNTRY

<span class="c">#----------------------------------------------------------#</span>
<span class="c"># 各種サービスを公開する場合の設定(ここから)               #</span>
<span class="c">#----------------------------------------------------------#</span>

<span class="c"># 外部からのTCP22番ポート(SSH)へのアクセスを日本からのみ許可</span>
<span class="c"># ※SSHサーバーを公開する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 22 <span class="nt">-j</span> ACCEPT_COUNTRY

<span class="c"># 外部からのTCP/UDP53番ポート(DNS)へのアクセスを許可</span>
<span class="c"># ※外部向けDNSサーバーを運用する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 53 <span class="nt">-j</span> ACCEPT
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> udp <span class="nt">--dport</span> 53 <span class="nt">-j</span> ACCEPT

<span class="c"># 外部からのTCP80番ポート(HTTP)へのアクセスを許可</span>
<span class="c"># ※Webサーバーを公開する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 80 <span class="nt">-j</span> ACCEPT

<span class="c"># 外部からのTCP443番ポート(HTTPS)へのアクセスを許可</span>
<span class="c"># ※Webサーバーを公開する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 443 <span class="nt">-j</span> ACCEPT

<span class="c"># 外部からのTCP21番ポート(FTP)へのアクセスを日本からのみ許可</span>
<span class="c"># ※FTPサーバーを公開する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 21 <span class="nt">-j</span> ACCEPT_COUNTRY

<span class="c"># 外部からのPASV用ポート(FTP-DATA)へのアクセスを日本からのみ許可</span>
<span class="c"># ※FTPサーバーを公開する場合のみ</span>
<span class="c"># ※PASV用ポート60000:60030は当サイトの設定例</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 60000:60030 <span class="nt">-j</span> ACCEPT_COUNTRY

<span class="c"># 外部からのTCP25番ポート(SMTP)へのアクセスを許可</span>
<span class="c"># ※SMTPサーバーを公開する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 25 <span class="nt">-j</span> ACCEPT

<span class="c"># 外部からのTCP465番ポート(SMTPS)へのアクセスを日本からのみ許可</span>
<span class="c"># ※SMTPSサーバーを公開する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 465 <span class="nt">-j</span> ACCEPT_COUNTRY

<span class="c"># 外部からのTCP110番ポート(POP3)へのアクセスを日本からのみ許可</span>
<span class="c"># ※POP3サーバーを公開する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 110 <span class="nt">-j</span> ACCEPT_COUNTRY

<span class="c"># 外部からのTCP995番ポート(POP3S)へのアクセスを日本からのみ許可</span>
<span class="c"># ※POP3Sサーバーを公開する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 995 <span class="nt">-j</span> ACCEPT_COUNTRY

<span class="c"># 外部からのTCP143番ポート(IMAP)へのアクセスを日本からのみ許可</span>
<span class="c"># ※IMAPサーバーを公開する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 143 <span class="nt">-j</span> ACCEPT_COUNTRY

<span class="c"># 外部からのTCP993番ポート(IMAPS)へのアクセスを日本からのみ許可</span>
<span class="c"># ※IMAPSサーバーを公開する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">--dport</span> 993 <span class="nt">-j</span> ACCEPT_COUNTRY

<span class="c"># 外部からのUDP1194番ポート(OpenVPN)へのアクセスを日本からのみ許可</span>
<span class="c"># ※OpenVPNサーバーを公開する場合のみ</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-p</span> udp <span class="nt">--dport</span> 1194 <span class="nt">-j</span> ACCEPT_COUNTRY

<span class="c"># VPNインタフェース用ファイアウォール設定</span>
<span class="c"># ※OpenVPNサーバーを公開する場合のみ</span>
<span class="o">[</span> <span class="nt">-f</span> /etc/openvpn/openvpn-startup <span class="o">]</span> <span class="o">&amp;&amp;</span> /etc/openvpn/openvpn-startup

<span class="c">#----------------------------------------------------------#</span>
<span class="c"># 各種サービスを公開する場合の設定(ここまで)               #</span>
<span class="c">#----------------------------------------------------------#</span>

<span class="c"># 拒否IPアドレスからのアクセスはログを記録せずに破棄</span>
<span class="c"># ※拒否IPアドレスは/root/deny_ipに1行ごとに記述しておくこと</span>
<span class="c"># (/root/deny_ipがなければなにもしない)</span>
<span class="k">if</span> <span class="o">[</span> <span class="nt">-s</span> /root/deny_ip <span class="o">]</span><span class="p">;</span> <span class="k">then
    for </span>ip <span class="k">in</span> <span class="sb">`</span><span class="nb">cat</span> /root/deny_ip<span class="sb">`</span>
    <span class="k">do
        </span>iptables <span class="nt">-I</span> INPUT <span class="nt">-s</span> <span class="nv">$ip</span> <span class="nt">-j</span> DROP
    <span class="k">done
fi</span>

<span class="c"># 上記のルールにマッチしなかったアクセスはログを記録して破棄</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-m</span> limit <span class="nt">--limit</span> 1/s <span class="nt">-j</span> LOG <span class="nt">--log-prefix</span> <span class="s1">'[IPTABLES INPUT] : '</span>
iptables <span class="nt">-A</span> INPUT <span class="nt">-j</span> DROP
iptables <span class="nt">-A</span> FORWARD <span class="nt">-m</span> limit <span class="nt">--limit</span> 1/s <span class="nt">-j</span> LOG <span class="nt">--log-prefix</span> <span class="s1">'[IPTABLES FORWARD] : '</span>
iptables <span class="nt">-A</span> FORWARD <span class="nt">-j</span> DROP

<span class="c"># サーバー再起動時にも上記設定が有効となるようにルールを保存</span>
/etc/rc.d/init.d/iptables save

<span class="c"># ファイアウォール起動</span>
/etc/rc.d/init.d/iptables start
</pre></td></tr></tbody></table></code></pre></figure>

<h3 id="2-ファイアウォール設定スクリプト外部関数作成">2. ファイアウォール設定スクリプト外部関数作成</h3>

<p>ファイアウォール設定スクリプト内で使用する外部関数用ファイルを以下のように作成する。</p>

<p>File: <code class="language-plaintext highlighter-rouge">iptables_functions</code></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="code"><pre><span class="c"># IPアドレスリスト取得関数定義</span>
IPLISTGET<span class="o">(){</span>
    <span class="c"># http://nami.jp/ipv4bycc/から最新版IPアドレスリストを取得する</span>
    wget <span class="nt">-q</span> http://nami.jp/ipv4bycc/cidr.txt.gz
    <span class="nb">gunzip </span>cidr.txt.gz
    <span class="c"># 最新版IPアドレスリストが取得できなかった場合</span>
    <span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nt">-f</span> cidr.txt <span class="o">]</span><span class="p">;</span> <span class="k">then
        if</span> <span class="o">[</span> <span class="nt">-f</span> /tmp/cidr.txt <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
            <span class="c"># バックアップがある場合はその旨をroot宛にメール通知して処理を打ち切る</span>
            <span class="nb">echo </span>cidr.txt was <span class="nb">read </span>from the backup! | mail <span class="nt">-s</span> <span class="nv">$0</span> root
            <span class="k">return
        else</span>
            <span class="c"># バックアップがない場合はその旨をroot宛にメール通知して処理を打ち切る</span>
            <span class="nb">echo </span>cidr.txt not found!|mail <span class="nt">-s</span> <span class="nv">$0</span> root
            <span class="nb">exit </span>1
        <span class="k">fi
    fi</span>
    <span class="c"># 最新版IPアドレスリストを /tmpへバックアップする</span>
    /bin/mv cidr.txt /tmp/cidr.txt
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></figure>

<h3 id="3-ip-アドレスリストチェックスクリプト作成">3. IP アドレスリストチェックスクリプト作成</h3>

<p>IP アドレスリストチェックスクリプトを以下のように作成する。</p>

<p>File: <code class="language-plaintext highlighter-rouge">/etc/cron.daily/iplist_check.sh</code></p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>

<span class="nv">PATH</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

<span class="c"># 新旧IPLIST差分チェック件数(0を指定するとチェックしない)</span>
<span class="c"># ※新旧IPLIST差分がSABUN_CHKで指定した件数を越える場合はiptables設定スクリプトを実行しない</span>
<span class="c"># ※新旧IPLIST差分チェック理由はhttp://centossrv.com/bbshtml/webpatio/1592.shtmlを参照</span>
<span class="nv">SABUN_CHK</span><span class="o">=</span>9999
<span class="o">[</span> <span class="nv">$# </span><span class="nt">-ne</span> 0 <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">SABUN_CHK</span><span class="o">=</span><span class="k">${</span><span class="nv">1</span><span class="k">}</span>

<span class="c"># チェック国コード</span>
<span class="nv">COUNTRY_CODE</span><span class="o">=</span><span class="s1">'JP CN TW RU'</span>

<span class="c"># iptables設定スクリプトパス</span>
<span class="nv">IPTABLES</span><span class="o">=</span>/root/iptables.sh

<span class="c"># iptables設定スクリプト外部関数取り込み</span>
<span class="nb">.</span> /root/iptables_functions

<span class="c"># IPアドレスリスト最新化</span>
<span class="nb">rm</span> <span class="nt">-f</span> IPLIST.new
IPLISTGET
<span class="k">for </span>country <span class="k">in</span> <span class="nv">$COUNTRY_CODE</span>
<span class="k">do
    if</span> <span class="o">[</span> <span class="nt">-f</span> /tmp/cidr.txt <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">grep</span> ^<span class="nv">$country</span> /tmp/cidr.txt <span class="o">&gt;&gt;</span> IPLIST.new
    <span class="k">else
        </span><span class="nb">grep</span> ^<span class="nv">$country</span> /tmp/IPLIST <span class="o">&gt;&gt;</span> IPLIST.new
    <span class="k">fi
done</span>
<span class="o">[</span> <span class="o">!</span> <span class="nt">-f</span> /tmp/IPLIST <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">cp </span>IPLIST.new /tmp/IPLIST

<span class="c"># IPアドレスリスト更新チェック</span>
diff <span class="nt">-q</span> /tmp/IPLIST IPLIST.new <span class="o">&gt;</span> /dev/null 2&gt;&amp;1
<span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="nt">-ne</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then
    if</span> <span class="o">[</span> <span class="k">${</span><span class="nv">SABUN_CHK</span><span class="k">}</span> <span class="nt">-ne</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then
        if</span> <span class="o">[</span> <span class="si">$(</span>diff /tmp/IPLIST IPLIST.new | egrep <span class="nt">-c</span> <span class="s1">'&lt;|&gt;'</span><span class="si">)</span> <span class="nt">-gt</span> <span class="k">${</span><span class="nv">SABUN_CHK</span><span class="k">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
            <span class="o">(</span>
             diff /tmp/IPLIST IPLIST.new
             <span class="nb">echo
             echo</span> <span class="s2">"</span><span class="nv">$IPTABLES</span><span class="s2"> not executed."</span>
            <span class="o">)</span> | mail <span class="nt">-s</span> <span class="s1">'IPLIST UPDATE'</span> root
            <span class="nb">rm</span> <span class="nt">-f</span> IPLIST.new
            <span class="nb">exit
        </span><span class="k">fi
    fi</span>
    /bin/mv IPLIST.new /tmp/IPLIST
    sh <span class="nv">$IPTABLES</span> <span class="o">&gt;</span> /dev/null
<span class="k">else
    </span><span class="nb">rm</span> <span class="nt">-f</span> IPLIST.new
<span class="k">fi</span>
</pre></td></tr></tbody></table></code></pre></figure>

<h3 id="4-ip-アドレスリストチェックスクリプト権限設定">4. IP アドレスリストチェックスクリプト権限設定</h3>

<p>IP アドレスリストチェックスクリプトに実行権限を付与する。</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code># chmod +x /etc/cron.daily/iplist_check.sh
</code></pre></div></div>

<h3 id="5-iptables-起動">5. iptables 起動</h3>

<p>以下のようにして iptables を起動する。</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code># sh iptables.sh
iptables: ファイアウォールのルールを /etc/sysconfig/iptable[  OK  ]中:
iptables: ファイアウォールルールを適用中:                  [  OK  ]
</code></pre></div></div>

<h3 id="6-iptables-自動起動設定">6. iptables 自動起動設定</h3>

<p>マシン起動時に iptables が自動で起動するよう設定する。</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code># chkconfig iptables on
# chkconfig --list iptables     # &lt;= 2,3,4,5 が "on" であることを確認
iptables        0:off   1:off   2:on    3:on    4:on    5:on    6:off
</code></pre></div></div>

<h3 id="参考サイト">参考サイト</h3>

<ul>
  <li><a href="http://centossrv.com/" title="CentOSで自宅サーバー構築">CentOSで自宅サーバー構築</a></li>
</ul>

<hr />

<p>次回は、DNS サーバ BIND の構築について紹介する予定です。</p>

<p>以上。</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/centos" class="page__taxonomy-item" rel="tag">CentOS</a><span class="sep">, </span>
    
      
      
      <a href="/tags/linux" class="page__taxonomy-item" rel="tag">Linux</a><span class="sep">, </span>
    
      
      
      <a href="/tags/%E3%83%95%E3%82%A1%E3%82%A4%E3%82%A2%E3%82%A6%E3%82%A9%E3%83%BC%E3%83%AB" class="page__taxonomy-item" rel="tag">ファイアウォール</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/%E3%82%B5%E3%83%BC%E3%83%90%E6%A7%8B%E7%AF%89" class="page__taxonomy-item" rel="tag">サーバ構築</a>
    
    </span>
  </p>


        
          
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2013-12-20T00:20:00+09:00">2013-12-20 00:20</time></p>
        
        <br />
      </footer>
      <div id="google-ad-3"></div>
      <br />
      <br />
      <br />
      <br />

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=rsm_mzk&text=CentOS+6.5+-+%E3%83%95%E3%82%A1%E3%82%A4%E3%82%A2%E3%82%A6%E3%82%A9%E3%83%BC%E3%83%AB%EF%BC%88iptables%EF%BC%89%E6%A7%8B%E7%AF%89%EF%BC%81%20https%3A%2F%2Fkomasaru.github.io%2F2013%2F12%2F20%2Fcentos-6-5-iptables-installation%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkomasaru.github.io%2F2013%2F12%2F20%2Fcentos-6-5-iptables-installation%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  

  <a href="https://www.tumblr.com/share" class="btn btn--tumblr" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Tumblr"><i class="fab fa-fw fa-tumblr" aria-hidden="true"></i><span> Tumblr</span></a><script id="tumblr-js" async src="https://assets.tumblr.com/share-button.js"></script>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fkomasaru.github.io%2F2013%2F12%2F20%2Fcentos-6-5-iptables-installation%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      <section>
        &nbsp;
        <h4>Sponsored Link</h4>
        <div id="rakuten-ad"></div>
        <div id="amazon-ad-1"></div>
      </section>
      &nbsp;
      
  <nav class="pagination">
    
      <a href="/2013/12/19/centos-6-5-clamantivirus-installation/" class="pagination--pager" title="CentOS 6.5 - アンチウイルスソフト（Clam AntiVirus）導入！
">Previous</a>
    
    
      <a href="/2013/12/21/centos-6-5-bind-installation/" class="pagination--pager" title="CentOS 6.5 - DNS サーバ（BIND）構築！
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comments</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
    <div class="page__related">
      <div id="google-ad-4"></div>
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2023/11/29/debian-12-groonga-installation-by-official-apt/" rel="permalink">Debian 12 (bookworm) - 全文検索エンジン Groonga インストール（by Groonga 公式リポジトリ）！
</a>
        &nbsp;<small>(2023-11-29)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">Debian GNU/Linux 12 (bookworm) にカラムストア機能付き全文検索エンジン Groonga を Groonga の公式リポジトリを使用して導入する方法についての記録です。

以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となってい...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2023/11/22/debian-12-postfix-log-analysis/" rel="permalink">Debian 12 (bookworm) - Postfix ログ解析！
</a>
        &nbsp;<small>(2023-11-22)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">Debian GNU/Linux 12 (bookworm) に導入した SMTP サーバ Postfix のログを解析する方法についての記録です。

以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。
（当然ながら、興味がなければスルーしてく...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2023/11/15/debian-12-postfix-anti-virus-with-clamav/" rel="permalink">Debian 12 (bookworm) - Postfix ウィルス・スパム対策(ClamAV)！
</a>
        &nbsp;<small>(2023-11-15)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">Debian GNU/Linux 12 (bookworm) にアンチウイルスソフト ClamAV をインストールする方法についての記録です。

以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。
（当然ながら、興味がなければスルーしてください...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2023/11/08/debian-12-mail-ssl-setting/" rel="permalink">Debian 12 (bookworm) - メールサーバ SSL 設定！
</a>
        &nbsp;<small>(2023-11-08)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">Debian GNU/Linux 12 (bookworm) に導入したメールサーバを SSL 設定する方法についての記録です。

以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。
（当然ながら、興味がなければスルーしてください）

</p>
  </article>
</div>

        
      </div>
      <!-- &nbsp;
      <div id="amazon-wd"></div -->
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form onsubmit="return googleCustomSearchExecute();" id="cse-search-box-form-id">
    <input type="text" id="cse-search-input-box-id" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    </form>
    <div id="results" class="results">
        <gcse:searchresults-only></gcse:searchresults-only>    
    </div></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<div id="qr"><img src="/assets/images/qr.png" alt="mk-mode BLOG"></div>
<div id="google-ad-5"></div>
<div class="page__footer-etc">
  <strong>ブログ開設日</strong> <tt>2009-01-05</tt><br />
  <strong>サーバ連続稼働時間</strong> <tt id="uptime">Loading...</tt><br />
  <strong>Page View</strong><br />
  &emsp;合計 <tt id="pv-total">Loading...</tt><br />
  &emsp;今日 <tt id="pv-today">Loading...</tt><br />
  &emsp;昨日 <tt id="pv-yesterday">Loading...</tt><br />
  <small>※<a href="/privacy.html" title="「プライバシーポリシー」ページへ">プライバシーポリシー</a></small>
</div>
<p id="page-top">
  <a href="#">
    <i class="fa fa-angle-double-up fa-2x" aria-hidden="true"></i>
  </a>
</p>
<!-- end custom footer snippets -->

        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/rsm_mzk" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
      
        
          <li><a href="https://github.com/komasaru" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="https://www.mk-mode.com/blog/atom.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 mk-mode.com. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script defer src="/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.6.0/js/all.js" integrity="sha384-z9ZOvGHHo21RqN5De4rfJMoAxYpaVoiYhuJXPyVmSs8yn20IE3PmBM534CffwSJI" crossorigin="anonymous"></script>
  <script defer src="/assets/js/my_custom.js"></script>


<script>
  (function () {
    var cx = 'partner-pub-7320193476057758:6328726109';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();

  function googleCustomSearchExecute() {
    var input = document.getElementById('cse-search-input-box-id');
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (input.value == '') {
      element.clearAllResults();
    } else {
      element.execute(input.value);
    }
    return false;
  }

  
</script>




  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18154748-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>





    
  <script>
    var disqus_config = function () {
      this.page.url = "https://komasaru.github.io/2013/12/20/centos-6-5-iptables-installation/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/2013/12/20/centos-6-5-iptables-installation"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://mkmodeblog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  



  </body>
</html>
