<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ja" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Fortran - 二項係数の計算！ - mk-mode BLOG</title>
<meta name="description" content="Fortran 95 で二項係数の計算をしてみました。（各種計算式を使用して）また、計算結果が多倍長になることを考慮し、多倍長演算ライブラリ FMLIB を使用しています。">



<meta property="og:type" content="article">
<meta property="og:locale" content="ja_JP">
<meta property="og:site_name" content="mk-mode BLOG">
<meta property="og:title" content="Fortran - 二項係数の計算！">
<meta property="og:url" content="https://komasaru.github.io/2020/02/08/fortran95-binomial-coefficients/">


  <meta property="og:description" content="Fortran 95 で二項係数の計算をしてみました。（各種計算式を使用して）また、計算結果が多倍長になることを考慮し、多倍長演算ライブラリ FMLIB を使用しています。">



  <meta property="og:image" content="https://www.mk-mode.com/blog/assets/images/about_me.png">



  <meta name="twitter:site" content="@rsm_mzk">
  <meta name="twitter:title" content="Fortran - 二項係数の計算！">
  <meta name="twitter:description" content="Fortran 95 で二項係数の計算をしてみました。（各種計算式を使用して）また、計算結果が多倍長になることを考慮し、多倍長演算ライブラリ FMLIB を使用しています。">
  <meta name="twitter:url" content="https://komasaru.github.io/2020/02/08/fortran95-binomial-coefficients/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://www.mk-mode.com/blog/assets/images/about_me.png">
    
  

  



  <meta property="article:published_time" content="2020-02-08T00:20:00+09:00">





  

  


<link rel="canonical" href="https://komasaru.github.io/2020/02/08/fortran95-binomial-coefficients/">





  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "url": "https://komasaru.github.io",
      "logo": "https://www.mk-mode.com/blog/assets/images/about_me.png"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "mk-mode.com",
      "url": "https://komasaru.github.io",
      "sameAs": null
    }
  </script>



  <meta name="google-site-verification" content="0kSwKhNo71fC7OeEFLllD3S11F8Pa-z_OqsBTSFxXAk" />





<!-- end _includes/seo.html -->


<link href="https://www.mk-mode.com/blog/atom.xml" type="application/atom+xml" rel="alternate" title="mk-mode BLOG Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


  
    
    <script defer src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    <!-- start custom head snippets -->

<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="//pagead2.googlesyndication.com" />
<link rel="dns-prefetch" href="//googleads.g.doubleclick.net" />
<link rel="dns-prefetch" href="//tpc.googlesyndication.com" />
<link rel="dns-prefetch" href="//cm.g.doubleclick.net" />
<link rel="dns-prefetch" href="//www.gstatic.com" />
<link rel="dns-prefetch" href="//fonts.gstatic.com" />
<link rel='dns-prefetch' href='//use.fontawesome.com' />
<link rel="dns-prefetch" href="//twitter.com" />
<link rel="dns-prefetch" href="//www.facebook.com" />

<link rel="icon" href="/assets/images/favicon.ico">
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18154748-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-7320193476057758",
      enable_page_level_ads: true
    });
  </script>


<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">mk-mode BLOG</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/year-archive/" >Archives</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.mk-mode.com/rails/calendar/calendar" >Calendar</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.mk-mode.com/rails/jmaxml" >JMAXML</a>
            </li><li class="masthead__menu-item">
              <a href="/privacy.html" >Privacy Policy</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/about_me.png" alt="mk-mode.com" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">mk-mode.com</h3>
    
    
      <p class="author__bio" itemprop="description">
        Linux, Debian, IT, Server, PG, Ruby, Rails, Python, C++, Fortran, PC, MariaDB, math, GIS, etc...
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Ruby City MATSUE</span>
        </li>
      

      
        
          
        
          
            <li><a href="https://www.mk-mode.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode SITE</a></li>
          
        
          
            <li><a href="https://komasaru.github.io" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode BLOG (clone)</a></li>
          
        
          
            <li><a href="https://mk-mode.tumblr.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode TUMBLR</a></li>
          
        
          
            <li><a href="https://mk-ephemeris.tumblr.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> mk-mode EPHEMERIS</a></li>
          
        
          
            <li><a href="https://twitter.com/rsm_mzk" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
          
        
          
        
          
            <li><a href="https://github.com/komasaru" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Fortran - 二項係数の計算！">
    <meta itemprop="description" content="Fortran 95 で二項係数の計算をしてみました。（各種計算式を使用して）また、計算結果が多倍長になることを考慮し、多倍長演算ライブラリ FMLIB を使用しています。">
    <meta itemprop="datePublished" content="February 08, 2020">
    

    <div class="page__inner-wrap">
      
        <header>
          <!-- div id="google-ad-1"></div -->
          <h1 id="page-title" class="page__title" itemprop="headline">Fortran - 二項係数の計算！
</h1>
          
          
            
            <p class="page__date"><small><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-02-08T00:20:00+09:00">2020-02-08 00:20</time></small></p>
          
        </header>
      
      <div id="google-ad-2"></div>
      <br />

      <section class="page__content" itemprop="text">
        
        <p>Fortran 95 で二項係数の計算をしてみました。（各種計算式を使用して）<br />
また、計算結果が多倍長になることを考慮し、多倍長演算ライブラリ FMLIB を使用しています。</p>

<!--more-->

<h3 id="0-前提条件">0. 前提条件</h3>

<ul>
  <li>Debian GNU/Linux 10.2 (64bit) での作業を想定。</li>
  <li>GCC 9.2.0 (GFortran 9.2.0) でのコンパイルを想定。</li>
  <li>多倍長演算（多桁計算）には、 FMLIB を使用する。（後述 3 ）</li>
</ul>

<h3 id="1-二項係数について">1. 二項係数について</h3>

<p>\(n\) 個の物から \(r\) 個のものを選ぶ組み合わせは \(_nC_r\) 通りあり、 \(\displaystyle \binom{n}{r}\) とも表す。また、二項級数（二項定理）の係数であることから、 \(\textbf{二項係数}\)とも呼ばれる。</p>

<p>以下、二項係数の主な重要性質。</p>

\[\begin{eqnarray}
\binom{n}{r} &amp;=&amp; _nC_r = \frac{_nP_r}{r!} = \frac{n!}{r!(n - r)!} \tag{1} \\
\binom{n}{r} &amp;=&amp; \binom{n}{n-r} \\
\binom{n}{0} &amp;=&amp; 1 \\
\binom{n}{r} &amp;=&amp; \binom{n-1}{r} + \binom{n-1}{r-1} \tag{2} \\
\binom{n}{r} &amp;=&amp; \frac{n}{r}\binom{n-1}{r-1} \tag{3} \\
\binom{n}{r} &amp;=&amp; \frac{n^{\underline{r}}}{r!} = \frac{n(n-1)(n-2)\cdots(n-(r-1))}{r(r-1)(r-2)\cdots1} = \prod_{i=1}^{r}\frac{n-i+1}{i} \tag{4} \\
&amp;&amp;(n^{\underline{r}}は下降階乗冪) \nonumber
\end{eqnarray}\]

<h3 id="2-fortran-ソースコードの作成">2. Fortran ソースコードの作成</h3>

<ul>
  <li>4種の計算式を使用する。（前述の (1), (2), (3), (4)）<br />
（使用する計算式（メソッド）の切り替えはコメント／アンコメントで）</li>
</ul>

<p>まず、計算用モジュール。</p>

<p>File: <code class="language-plaintext highlighter-rouge">binom_coeff.f95</code></p>

<figure class="highlight"><pre><code class="language-fortran" data-lang="fortran"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
</pre></td><td class="code"><pre><span class="c1">!****************************************************</span><span class="w">
</span><span class="c1">! 二項係数の計算</span><span class="w">
</span><span class="c1">!</span><span class="w">
</span><span class="c1">! DATE          AUTHOR          VERSION</span><span class="w">
</span><span class="c1">! 2019.12.11    mk-mode.com     1.00 新規作成</span><span class="w">
</span><span class="c1">!</span><span class="w">
</span><span class="c1">! Copyright(C) 2019 mk-mode.com All Rights Reserved.</span><span class="w">
</span><span class="c1">!****************************************************</span><span class="w">
</span><span class="c1">!</span><span class="w">
</span><span class="k">module</span><span class="w"> </span><span class="n">cst</span><span class="w">
  </span><span class="c1">! SP: 単精度(4), DP: 倍精度(8)</span><span class="w">
  </span><span class="kt">integer</span><span class="p">,</span><span class="w">     </span><span class="k">parameter</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">SP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">kind</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="w">
  </span><span class="kt">integer</span><span class="p">(</span><span class="n">SP</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">DP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">selected_real_kind</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">precision</span><span class="p">(</span><span class="mf">1.0_SP</span><span class="p">))</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">cst</span><span class="w">

</span><span class="k">module</span><span class="w"> </span><span class="n">cmn</span><span class="w">
  </span><span class="k">use</span><span class="w"> </span><span class="n">cst</span><span class="w">
  </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">

  </span><span class="k">private</span><span class="w">
  </span><span class="k">public</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">get_arg</span><span class="w">

</span><span class="k">contains</span><span class="w">
  </span><span class="c1">! コマンドライン引数(n, r)の取得</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="c1">! :param(out) integer(4) n</span><span class="w">
  </span><span class="c1">! :param(out) integer(4) r</span><span class="w">
  </span><span class="k">subroutine</span><span class="w"> </span><span class="n">get_arg</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w">
    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
    </span><span class="kt">integer</span><span class="p">(</span><span class="n">SP</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">out</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w">
    </span><span class="kt">character</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">a</span><span class="w">
    </span><span class="kt">integer</span><span class="p">(</span><span class="n">SP</span><span class="p">)</span><span class="w">  </span><span class="p">::</span><span class="w"> </span><span class="n">ios</span><span class="w">

    </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iargc</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">
      </span><span class="k">call</span><span class="w"> </span><span class="n">getarg</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w">
      </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ios</span><span class="p">)</span><span class="w"> </span><span class="n">n</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ios</span><span class="w"> </span><span class="p">/</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w">
      </span><span class="k">call</span><span class="w"> </span><span class="n">getarg</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w">
      </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ios</span><span class="p">)</span><span class="w"> </span><span class="n">r</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ios</span><span class="w"> </span><span class="p">/</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">if</span><span class="w">
  </span><span class="k">end</span><span class="w"> </span><span class="k">subroutine</span><span class="w"> </span><span class="n">get_arg</span><span class="w">

</span><span class="k">end</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">cmn</span><span class="w">

</span><span class="k">module</span><span class="w"> </span><span class="n">comp</span><span class="w">
  </span><span class="k">use</span><span class="w"> </span><span class="n">cst</span><span class="w">
  </span><span class="k">use</span><span class="w"> </span><span class="n">FMZM</span><span class="w">
  </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
  </span><span class="k">private</span><span class="w">
  </span><span class="k">public</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">binom_1</span><span class="p">,</span><span class="w"> </span><span class="n">binom_2</span><span class="p">,</span><span class="w"> </span><span class="n">binom_3</span><span class="p">,</span><span class="w"> </span><span class="n">binom_4</span><span class="w">

</span><span class="k">contains</span><span class="w">
  </span><span class="c1">! 二項係数の計算(1)</span><span class="w">
  </span><span class="c1">!   計算式: (n r) = n! / r!(n -r)!</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="c1">! :param(in) integer(4) n</span><span class="w">
  </span><span class="c1">! :param(in) integer(4) r</span><span class="w">
  </span><span class="c1">! :return    type(IM)   b</span><span class="w">
  </span><span class="k">function</span><span class="w"> </span><span class="n">binom_1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">cst</span><span class="w">
    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
    </span><span class="kt">integer</span><span class="p">(</span><span class="n">SP</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w">
    </span><span class="k">type</span><span class="p">(</span><span class="n">IM</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">b</span><span class="w">

    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TO_IM</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">.or.</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w">
    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">fact</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="p">(</span><span class="n">fact</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">fact</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">))</span><span class="w">
  </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">binom_1</span><span class="w">

  </span><span class="c1">! 二項係数の計算(2)</span><span class="w">
  </span><span class="c1">!   計算式: (n r) = ((n - 1) r) + ((n - 1) (k - 1))</span><span class="w">
  </span><span class="c1">!           (recursively)</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="c1">! :param(in) integer(4) n</span><span class="w">
  </span><span class="c1">! :param(in) integer(4) r</span><span class="w">
  </span><span class="c1">! :return    type(IM)   b</span><span class="w">
  </span><span class="k">recursive</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">binom_2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">cst</span><span class="w">
    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
    </span><span class="kt">integer</span><span class="p">(</span><span class="n">SP</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w">
    </span><span class="k">type</span><span class="p">(</span><span class="n">IM</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">b</span><span class="w">

    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TO_IM</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">.or.</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w">
    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">binom_2</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">binom_2</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">
  </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">binom_2</span><span class="w">

  </span><span class="c1">! 二項係数の計算(3)</span><span class="w">
  </span><span class="c1">!   計算式: (n r) = (n / r) * ((n - 1) (k - 1))</span><span class="w">
  </span><span class="c1">!           (recursively)</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="c1">! :param(in) integer(4) n</span><span class="w">
  </span><span class="c1">! :param(in) integer(4) r</span><span class="w">
  </span><span class="c1">! :return    type(IM)   b</span><span class="w">
  </span><span class="k">recursive</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">binom_3</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">cst</span><span class="w">
    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
    </span><span class="kt">integer</span><span class="p">(</span><span class="n">SP</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w">
    </span><span class="k">type</span><span class="p">(</span><span class="n">IM</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">b</span><span class="w">

    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TO_IM</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">.or.</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w">
    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">binom_3</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="n">r</span><span class="w">
  </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">binom_3</span><span class="w">

  </span><span class="c1">! 二項係数の計算(4)</span><span class="w">
  </span><span class="c1">!   計算式: (n r) = Π(n - i + 1) / i  (i = 1, ..., r)</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="c1">! :param(in) integer(4) n</span><span class="w">
  </span><span class="c1">! :param(in) integer(4) r</span><span class="w">
  </span><span class="c1">! :return    type(IM)   b</span><span class="w">
  </span><span class="k">function</span><span class="w"> </span><span class="n">binom_4</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">cst</span><span class="w">
    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
    </span><span class="kt">integer</span><span class="p">(</span><span class="n">SP</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w">
    </span><span class="kt">integer</span><span class="p">(</span><span class="n">SP</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">i</span><span class="w">
    </span><span class="k">type</span><span class="p">(</span><span class="n">IM</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">b</span><span class="w">

    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TO_IM</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">.or.</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w">
    </span><span class="k">do</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w">
      </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="n">i</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">do</span><span class="w">
  </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">binom_4</span><span class="w">

  </span><span class="c1">! 階乗の計算</span><span class="w">
  </span><span class="c1">!</span><span class="w">
  </span><span class="c1">! :param(in) integer(4)  x</span><span class="w">
  </span><span class="c1">! :return    type(IM)</span><span class="w">
  </span><span class="k">type</span><span class="p">(</span><span class="n">IM</span><span class="p">)</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">fact</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
    </span><span class="k">use</span><span class="w"> </span><span class="n">cst</span><span class="w">
    </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
    </span><span class="kt">integer</span><span class="p">(</span><span class="n">SP</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="k">in</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">x</span><span class="w">
    </span><span class="kt">integer</span><span class="p">(</span><span class="n">SP</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">i</span><span class="w">

    </span><span class="n">fact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TO_IM</span><span class="p">(</span><span class="s1">'1'</span><span class="p">)</span><span class="w">
    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w">
    </span><span class="k">do</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w">
      </span><span class="n">fact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fact</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="w">
    </span><span class="k">end</span><span class="w"> </span><span class="k">do</span><span class="w">
  </span><span class="k">end</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">fact</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="k">module</span><span class="w"> </span><span class="n">comp</span><span class="w">

</span><span class="k">program</span><span class="w"> </span><span class="n">binom_coeff</span><span class="w">
  </span><span class="k">use</span><span class="w"> </span><span class="n">cst</span><span class="w">
  </span><span class="k">use</span><span class="w"> </span><span class="n">cmn</span><span class="w">
  </span><span class="k">use</span><span class="w"> </span><span class="n">comp</span><span class="w">
  </span><span class="k">use</span><span class="w"> </span><span class="n">FMZM</span><span class="w">
  </span><span class="k">implicit</span><span class="w"> </span><span class="k">none</span><span class="w">
  </span><span class="kt">integer</span><span class="p">(</span><span class="n">SP</span><span class="p">)</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w">
  </span><span class="k">type</span><span class="p">(</span><span class="n">IM</span><span class="p">)</span><span class="w">    </span><span class="p">::</span><span class="w"> </span><span class="n">b</span><span class="w">

  </span><span class="c1">! コマンドライン引数(n, r)取得</span><span class="w">
  </span><span class="k">call</span><span class="w"> </span><span class="n">get_arg</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">.and.</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">.or.</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">.or.</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w">
  </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">'("(", I5, " ", I5, ") = ")'</span><span class="p">,</span><span class="w"> </span><span class="n">advance</span><span class="o">=</span><span class="s1">'no'</span><span class="p">)</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="w">

  </span><span class="c1">! 計算</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="w">
  </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">binom_1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">)</span><span class="w">  </span><span class="c1">! binom_1 or 2 or 3 or 4</span><span class="w">
  </span><span class="k">call</span><span class="w"> </span><span class="n">IMPRINT</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w">
</span><span class="k">end</span><span class="w"> </span><span class="k">program</span><span class="w"> </span><span class="n">binom_coeff</span>
</pre></td></tr></tbody></table></code></pre></figure>

<ul>
  <li><a href="https://gist.github.com/komasaru/d4a44bc15bfe812fef73682cd14e52d8" title="Gist - Fortran 95 source code to calculate binomial coefficients.">Gist - Fortran 95 source code to calculate binomial coefficients.</a></li>
</ul>

<h3 id="3-fmlib-の準備">3. FMLIB の準備</h3>

<p>コンパイルに使用するので、同じディレクトリ内に FMLIB のオプジェクト／モジュールファイルのリンクを貼っておく。（煩わしくないのなら、コンパイル時にフルパスで指定してもよい。また、 Makefile を作成してビルドする方法でも良いだろう）</p>

<ul>
  <li>FMLIB のインストールについては過去記事を参照→ <a href="/2019/02/02/fortran-fmlib-installation" title="Fortran - 多倍長演算ライブラリ FMLIB のインストール！">Fortran - 多倍長演算ライブラリ FMLIB のインストール！</a></li>
</ul>

<h3 id="4-コンパイルリンク">4. コンパイル＆リンク</h3>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ gfortran -c -Wunused -O2 binom_coeff.f95
$ gfortran -o binom_coeff fmsave.o fm.o fmzm90.o binom_coeff.o
</code></pre></div></div>

<h3 id="5-プログラムの実行">5. プログラムの実行</h3>

<ul>
  <li>\(\displaystyle \binom{n}{r}\) を \((n\ r)\) で表示。</li>
  <li><code class="language-plaintext highlighter-rouge">r</code> が整数でない場合は <code class="language-plaintext highlighter-rouge">0</code> とみなす。</li>
  <li>ERROR の場合は、何も出力しない。</li>
  <li>結果出力のフォーマットは FMLIB 標準を使用。</li>
</ul>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ./binom_coeff 0 1

$ ./binom_coeff 1 -1

$ ./binom_coeff 1 0.9
(    1     0) =
      1

$ ./binom_coeff 1.1 1

$ ./binom_coeff 1 0
(    1     0) =
       1

$ ./binom_coeff 1 1
(    1     1) =
       1

$ ./binom_coeff 10 2
(   10     2) =
       45

$ ./binom_coeff 100 3
(  100     3) =
       161700

$ ./binom_coeff 1000 4
( 1000     4) =
       41417124750

$ ./binom_coeff 5000 500
( 5000   500) =
       152383570502276241773112299038287011759805517717774989612063963324852197
      7213499605908842337110820488640167595440545082577673904733594530228810459
      6412151481279032572628587506952815691445272815864618334838578548489705130
      2963702456469661925649013938025675652103406710218905355077057732196294852
      2784729534964403925405652386524965860952572318327807635250586542453767148
      3891366080586181114673093555560987897570461892398850728174637647049432100
      8996284739018893410735106722857930028973378877130054931747509530956061693
      3594701759502335749628087140048422879219219349951217774485328751901915494
      7662908564688029518280662169283594314245494781713166908858338292805012574
      1393952210717943794438066831202814961683139272640

$ ./binom_coeff 5000 2500
( 5000  2500) =
       159371868534943837569102579293591908725712943416872973851142188872518373
      8249343168628721321987372082216725114025558627431929452538403647953823060
      0454556577691298731223139197739339645846143083224492991761486489258473048
      0023643569324440941033122054431815988922710259363445810754908935865678405
      3736247584401420310445473681941570500042422596205820826613570804985152082
      4960607972807738936458482894499881130290028489658358418222712925568554614
      8432527106563886001286107377899921899687103515889919865427858237130967767
      1306096769432314126537889059653739614763267148184153554042435532017355139
      7630020464441895106536721014270759750902584263727315940982234214301739743
      0156968769327523500761058075924169787048410094516380576648834071389764219
      7106542283174953794968649783206558992619899425465272314921564909489372873
      9354576215354622894873385925840937185218967602378468492022604595977596090
      7469935996353111971038349697595257112068688379060221973084397646998338508
      2049193547335825798706248498798896761744609761227753857586204130073377729
      9911585208214180922176383626728533535383779826850949403248877209443871900
      0803033475881532546647063138520719622744967680682146446102287294664405588
      2208785540986721560176252586558088366726782973824315529862858085233856576
      6233367598650344799146790065148746117755061771145797054498841333445350685
      8551684298754661646355592385908765031330761376539376966719050679737673751
      8707832888662700172790377793259351868797507163339600827270303879295319252
      652644612708041188699645673663207276383716320
</code></pre></div></div>

<h3 id="6-ベンチマーク">6. ベンチマーク</h3>

<p>正確に計測はしていないが、<a href="/2020/02/05/ruby-binomial-coefficients" title="Ruby - 二項係数の計算！">Ruby 版</a>同様、 (2) が最も実行に時間がかかった。<br />
その他は  (4), (3), (1) の順で高速であった。</p>

<hr />

<p>以上。</p>


        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/ruby" class="page__taxonomy-item" rel="tag">Ruby</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0" class="page__taxonomy-item" rel="tag">プログラミング</a><span class="sep">, </span>
    
      
      
      <a href="/categories/%E6%95%B0%E5%AD%A6" class="page__taxonomy-item" rel="tag">数学</a>
    
    </span>
  </p>


        
          
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-02-08T00:20:00+09:00">2020-02-08 00:20</time></p>
        
        <br />
      </footer>
      <div id="google-ad-3"></div>
      <br />
      <br />
      <br />
      <br />

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=rsm_mzk&text=Fortran+-+%E4%BA%8C%E9%A0%85%E4%BF%82%E6%95%B0%E3%81%AE%E8%A8%88%E7%AE%97%EF%BC%81%20https%3A%2F%2Fkomasaru.github.io%2F2020%2F02%2F08%2Ffortran95-binomial-coefficients%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkomasaru.github.io%2F2020%2F02%2F08%2Ffortran95-binomial-coefficients%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  

  <a href="https://www.tumblr.com/share" class="btn btn--tumblr" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Tumblr"><i class="fab fa-fw fa-tumblr" aria-hidden="true"></i><span> Tumblr</span></a><script id="tumblr-js" async src="https://assets.tumblr.com/share-button.js"></script>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fkomasaru.github.io%2F2020%2F02%2F08%2Ffortran95-binomial-coefficients%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      <section>
        &nbsp;
        <h4>Sponsored Link</h4>
        <div id="rakuten-ad"></div>
        <div id="amazon-ad-1"></div>
      </section>
      &nbsp;
      
  <nav class="pagination">
    
      <a href="/2020/02/05/ruby-binomial-coefficients/" class="pagination--pager" title="Ruby - 二項係数の計算！
">Previous</a>
    
    
      <a href="/2020/02/11/ruby-rcc-spearman/" class="pagination--pager" title="Ruby - スピアマン順位相関係数の計算！
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comments</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
    <div class="page__related">
      <div id="google-ad-4"></div>
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2021/12/22/debian-11-mail-ssl-setting/" rel="permalink">Debian 11 (bullseye) - メールサーバ SSL 設定！
</a>
        &nbsp;<small>(2021-12-22)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">Debian GNU/Linux 11 (bullseye) に導入したメールサーバを SSL 設定する方法についての記録です。

以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。
（当然ながら、興味がなければスルーしてください）

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2021/12/15/debian-11-dovecot-installation/" rel="permalink">Debian 11 (bullseye) - POP/IMAP サーバ Dovecot 構築！
</a>
        &nbsp;<small>(2021-12-15)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">Debian GNU/Linux 11 (bullseye) に POP/IMAP サーバ Dovecot を構築する方法についての記録です。

以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。
（当然ながら、興味がなければスルーしてください）

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2021/12/08/debian-11-postfix-installation/" rel="permalink">Debian 11 (bullseye) - SMTP サーバ Postfix 構築！
</a>
        &nbsp;<small>(2021-12-08)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">Debian GNU/Linux 11 (bullseye) に SMTP サーバ Postfix を構築する方法についての記録です。

以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。
（当然ながら、興味がなければスルーしてください）

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h3 class="archive__item-title" itemprop="headline">
      
        <a href="/2021/12/02/debian-11-nfs-port-fixing/" rel="permalink">Debian 11 (bullseye) - NFS サーバのポート固定！
</a>
        &nbsp;<small>(2021-12-02)</small>
    </h3>
    
    <p class="archive__item-excerpt" itemprop="description">Debian GNU/Linux 11 (bullseye) に NFS サーバで使用するポートを固定化する方法についての記録です。

以前古いバージョンでの作業時に残していた記録を参考に作業を行い、今回更新した作業記録を貼付する形式の内容となっています。
（当然ながら、興味がなければスルーしてください）

</p>
  </article>
</div>

        
      </div>
      <!-- &nbsp;
      <div id="amazon-wd"></div -->
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form onsubmit="return googleCustomSearchExecute();" id="cse-search-box-form-id">
    <input type="text" id="cse-search-input-box-id" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    </form>
    <div id="results" class="results">
        <gcse:searchresults-only></gcse:searchresults-only>    
    </div></div>

      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<div id="qr"><img src="/assets/images/qr.png" alt="mk-mode BLOG"></div>
<div id="google-ad-5"></div>
<div class="page__footer-etc">
  <strong>ブログ開設日</strong> <tt>2009-01-05</tt><br />
  <strong>サーバ連続稼働時間</strong> <tt id="uptime">Loading...</tt><br />
  <strong>Page View</strong><br />
  &emsp;合計 <tt id="pv-total">Loading...</tt><br />
  &emsp;今日 <tt id="pv-today">Loading...</tt><br />
  &emsp;昨日 <tt id="pv-yesterday">Loading...</tt><br />
  <small>※<a href="/privacy.html" title="「プライバシーポリシー」ページへ">プライバシーポリシー</a></small>
</div>
<p id="page-top">
  <a href="#">
    <i class="fa fa-angle-double-up fa-2x" aria-hidden="true"></i>
  </a>
</p>
<!-- end custom footer snippets -->

        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/rsm_mzk" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
      
        
          <li><a href="https://github.com/komasaru" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="https://www.mk-mode.com/blog/atom.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 mk-mode.com. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script defer src="/assets/js/main.min.js"></script>
  <script defer src="https://use.fontawesome.com/releases/v5.6.0/js/all.js" integrity="sha384-z9ZOvGHHo21RqN5De4rfJMoAxYpaVoiYhuJXPyVmSs8yn20IE3PmBM534CffwSJI" crossorigin="anonymous"></script>
  <script defer src="/assets/js/my_custom.js"></script>


<script>
  (function () {
    var cx = 'partner-pub-7320193476057758:6328726109';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();

  function googleCustomSearchExecute() {
    var input = document.getElementById('cse-search-input-box-id');
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (input.value == '') {
      element.clearAllResults();
    } else {
      element.execute(input.value);
    }
    return false;
  }

  
</script>




  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18154748-1']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>





    
  <script>
    var disqus_config = function () {
      this.page.url = "https://komasaru.github.io/2020/02/08/fortran95-binomial-coefficients/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/2020/02/08/fortran95-binomial-coefficients"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://mkmodeblog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  



  </body>
</html>
